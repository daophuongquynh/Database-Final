CREATE TABLE LOAIHANG
(
	MaLoai varchar(10) not null primary key,
	TenLoai nvarchar(30)
);

CREATE TABLE GIAMGIA
(
	MaGiamGia varchar(5) not null primary key,
	TenGiamGia nvarchar(30),
	NgayBatDau date,
	NgayKetThuc date,
	MucGiam decimal(12,2)
);
CREATE TABLE KHO
(
	MaKho char(3) not null primary key,
	DiaChi nvarchar(100),
	SoLuongToiDa int,
);
CREATE TABLE MATHANG
(
	MaHang varchar(10) not null primary key,
	TenHang nvarchar(30),
	XuatXu nvarchar(20),
	GiaBan decimal(12,2),
	DonViTinh char(5),
	MaLoai varchar(10) FOREIGN KEY(MaLoai) REFERENCES LOAIHANG(MaLoai),
	MaKho char(3)FOREIGN KEY (MaKho) REFERENCES KHO(MaKho),
	SoLuongTon int,
	MaGiamGia varchar(5) FOREIGN KEY(MaGiamGia) REFERENCES GIAMGIA(MaGiamGia)
);

CREATE TABLE NHACUNGCAP
(
	MaNCC varchar(6) not null primary key,
	TenNCC nvarchar(50),
	Sdt char(10),
	DiaChi nvarchar(100)
);

CREATE TABLE NHANVIEN
(
	MaNV char(5) not null primary key,
	HoTen nvarchar(50),
	GioiTinh nvarchar(5) CHECK(GioiTinh IN (N'Nam', N'Nữ')),
	Sdt char(10),
	DiaChi nvarchar(100),
	ChucVu nvarchar(20),
	TenDangNhap varchar(20),
	MatKhau varchar(10)	
);

CREATE TABLE KHACHHANG
(
	MaKH varchar(10) not null primary key,
	HoTen nvarchar(50),
	GioiTinh nvarchar(5) CHECK(GioiTinh IN (N'Nam', N'Nữ')),
	Sdt char(10),
	DiaChi nvarchar(100),
	TenDangNhap varchar(20),
	MatKhau varchar(10)	
);

CREATE TABLE DONHANG
(
	MaDH varchar(10) not null primary key,
	MaKH varchar(10) FOREIGN KEY(MaKH) REFERENCES KHACHHANG(MaKH),
	HinhThucTT nvarchar(10) CHECK(HinhThucTT IN (N'Thẻ', N'Tiền mặt')),
	NgayDat date,
	NgayGiao date,
	DiaChiGiao nvarchar(100),
	TinhTrangTT nvarchar(20) CHECK(TinhTrangTT IN (N'Đã TT', N'Chưa TT')),
	TinhTrangGiao nvarchar(10) CHECK(TinhTrangGiao IN (N'Đang Giao', N'Đã Giao'))
);

CREATE TABLE CHITIETDONHANG
(
	MaDH varchar(10) FOREIGN KEY(MaDH) REFERENCES DONHANG(MaDH),
	MaHang varchar(10) FOREIGN KEY(MaHang) REFERENCES MATHANG(MaHang),
	SoLuong int,
	GiaBan decimal(12,2),
	GiaTien decimal (12,2),
	MaGiamGia varchar(5) FOREIGN KEY(MaGiamGia)  REFERENCES GIAMGIA(MaGiamGia),
	PRIMARY KEY (MaDH, MaHang)
);

CREATE TABLE PHIEUNHAP
(
	MaPN varchar(10) not null primary key,
	MaNCC varchar(6) FOREIGN KEY(MaNCC) REFERENCES NHACUNGCAP(MaNCC),
	MaNV char(5) FOREIGN KEY(MaNV) REFERENCES NHANVIEN(MaNV),
	NgayNhap date
);

CREATE TABLE CHITIETPHIEUNHAP
(
	MaPN varchar(10) FOREIGN KEY(MaPN) REFERENCES PHIEUNHAP(MaPN),
	MaHang varchar(10) FOREIGN KEY(MaHang) REFERENCES MATHANG(MaHang),
	SoLuong int,
	DonGia decimal(12,2),
	PRIMARY KEY ( MaPN, MaHang)
);

CREATE TABLE PHIEUXUAT
(
	MaPX varchar(10) not null primary key,
	MaNV char(5) FOREIGN KEY(MaNV) REFERENCES NHANVIEN(MaNV),
	NgayXuat date
);

CREATE TABLE CHITIETPHIEUXUAT
(
	MaPX varchar(10) FOREIGN KEY(MaPX) REFERENCES PHIEUXUAT(MaPX),
	MaDH varchar(10) FOREIGN KEY(MaDH) REFERENCES DONHANG(MaDH),
	MaHang varchar(10) FOREIGN KEY(MaHang) REFERENCES MATHANG(MaHang),
	SoLuong int,
	DonGia decimal(12,2),
	PRIMARY KEY (MaDH, MaPX, MaHang)
);

CREATE TABLE PHIEUGIAOHANG
(
	MaPG varchar(10) not null primary key,
	MaDH varchar(10) FOREIGN KEY(MaDH) REFERENCES DONHANG(MaDH),
	MaNV char(5) FOREIGN KEY(MaNV) REFERENCES NHANVIEN(MaNV),
	NgayGiao date,
	PhiVanChuyen decimal(12,2)
);

CREATE TABLE THANHTOAN 
(
	MaHDTT varchar(10) not null primary key,
	MaDH varchar(10) FOREIGN KEY(MaDH) REFERENCES DONHANG(MaDH),
	MaNV char(5) FOREIGN KEY(MaNV) REFERENCES NHANVIEN(MaNV),
	NgayTT date,
	SoTien decimal(12,2),
	TrangThai nvarchar(20) CHECK(TrangThai IN (N'Đã Thanh Toán', N'Chưa Thanh Toán'))
);

CREATE TABLE PHANQUYEN
(
	MaQuyen char(3) not null primary key,
	TenQuyen nvarchar(30),
	LoaiQuyen nvarchar(3)
	
);
ALTER TABLE PHANQUYEN
ALTER column LoaiQuyen nvarchar(100)
CREATE TABLE TAIKHOAN_QUYEN
(
	MaNV char(5) FOREIGN KEY(MANV) REFERENCES NHANVIEN(MaNV),
	MaQuyen char(3) FOREIGN KEY (MaQuyen) REFERENCES PHANQUYEN(MaQuyen)
	PRIMARY KEY (MaNV, MaQuyen)
);

CREATE TABLE KHACHHANG_QUYEN
(
	MaKH varchar(10) FOREIGN KEY(MaKH) REFERENCES KHACHHANG(MaKH),
	MaQuyen char(3) FOREIGN KEY (MaQuyen) REFERENCES PHANQUYEN(MaQuyen)
	PRIMARY KEY (MaKH, MaQuyen)
);

set dateformat DMY;
--INSERT THONG TIN VAO BANG LOAIHANG
INSERT INTO LOAIHANG VALUES ('LH001',N'Táo')
INSERT INTO LOAIHANG VALUES ('LH002',N'Nho')
INSERT INTO LOAIHANG VALUES ('LH003',N'Cam')
INSERT INTO LOAIHANG VALUES ('LH004',N'Bưởi')
INSERT INTO LOAIHANG VALUES ('LH005',N'Dưa hấu')
INSERT INTO LOAIHANG VALUES ('LH006',N'Việt quất')
INSERT INTO LOAIHANG VALUES ('LH007',N'Dâu tây')
INSERT INTO LOAIHANG VALUES ('LH008',N'Lê')
INSERT INTO LOAIHANG VALUES ('LH009',N'Cherry')
INSERT INTO LOAIHANG VALUES ('LH010',N'Xoài')

SELECT*FROM LOAIHANG

--INSERT THONG TIN VAO BANG GIAMGIA
INSERT INTO GIAMGIA VALUES (N'GG001',N'Giỗ Tổ Hùng Vương','04/04/2022','11/04/2022',0.03)
INSERT INTO GIAMGIA VALUES (N'GG002',N'Chào mừng 30/4 – 1/5','25/04/2022','01/05/2022',0.03)
INSERT INTO GIAMGIA VALUES (N'GG003',N'Quốc Khánh','25/08/2022','02/09/2022',0.02)
INSERT INTO GIAMGIA VALUES (N'GG004',N'Sinh nhật cửa hàng','06/10/2022','10/10/2022',0.05)
INSERT INTO GIAMGIA VALUES (N'GG005',N'Giáng Sinh - Năm mới ','15/12/2022','31/12/2022',0.03)
INSERT INTO GIAMGIA VALUES (N'GG006',N'Tết Nguyên Đán','10/01/2022','27/01/2022',0.05)
INSERT INTO GIAMGIA VALUES (N'GG007',N'Giỗ Tổ Hùng Vương','04/04/2022','11/04/2022',0.04)
INSERT INTO GIAMGIA VALUES (N'GG008',N'Chào mừng 30/4 – 1/5','25/04/2022','01/05/2022',0.03)
INSERT INTO GIAMGIA VALUES (N'GG009',N'Quốc Khánh','25/08/2022','02/09/2022',0.05)
INSERT INTO GIAMGIA VALUES (N'GG010',N'Sinh nhật cửa hàng','06/10/2022','10/10/2022',0.05)
INSERT INTO GIAMGIA VALUES (N'GG011',N'Giáng Sinh - Năm mới ','15/12/2022','31/12/2022',0.03)
INSERT INTO GIAMGIA VALUES (N'GG012',N'Tết Nguyên Đán','10/01/2022','27/01/2022',0.05)
INSERT INTO GIAMGIA VALUES (N'GG013',N'Giỗ Tổ Hùng Vương','04/04/2022','11/04/2022',0.03)
INSERT INTO GIAMGIA VALUES (N'GG014',N'Chào mừng 30/4 – 1/5','25/04/2022','01/05/2022',0.03)
INSERT INTO GIAMGIA VALUES (N'GG015',N'Quốc Khánh','25/08/2022','02/09/2022',0.02)
INSERT INTO GIAMGIA VALUES (N'GG016',N'Sinh nhật cửa hàng','06/10/2022','10/10/2022',0.05)
INSERT INTO GIAMGIA VALUES (N'GG017',N'Giáng Sinh - Năm mới ','15/12/2022','31/12/2022',0.03)
INSERT INTO GIAMGIA VALUES (N'GG018',N'Tết Nguyên Đán','10/01/2022','27/01/2022',0.04)
INSERT INTO GIAMGIA VALUES (N'GG019',N'Chào mừng 30/4 – 1/5','25/04/2022','01/05/2022',0.03)
INSERT INTO GIAMGIA VALUES (N'GG020',N'Quốc Khánh','25/08/2022','02/09/2022',0.05)
INSERT INTO GIAMGIA VALUES (N'GG021',N'Sinh nhật cửa hàng','06/10/2022','10/10/2022',0.05)
INSERT INTO GIAMGIA VALUES (N'GG022',N'Chào mừng 30/4 – 1/5','25/04/2022','01/05/2022',0.03)
INSERT INTO GIAMGIA VALUES (N'GG023',N'Quốc Khánh','25/08/2022','02/09/2022',0.05)
INSERT INTO GIAMGIA VALUES (N'GG024',N'Sinh nhật cửa hàng','06/10/2022','10/10/2022',0.05)
INSERT INTO GIAMGIA VALUES (N'GG025',N'Giáng Sinh - Năm mới ','15/12/2022','31/12/2022',0.03)
INSERT INTO GIAMGIA VALUES (N'GG026',N'Tết Nguyên Đán','10/01/2022','27/01/2022',0.05)
INSERT INTO GIAMGIA VALUES (N'GG027',N'Giỗ Tổ Hùng Vương','04/04/2022','11/04/2022',0.03)
INSERT INTO GIAMGIA VALUES (N'GG028',N'Chào mừng 30/4 – 1/5','25/04/2022','01/05/2022',0.03)
INSERT INTO GIAMGIA VALUES (N'GG029',N'Quốc Khánh','25/08/2022','02/09/2022',0.05)
INSERT INTO GIAMGIA VALUES (N'GG030',N'Sinh nhật cửa hàng','06/10/2022','10/10/2022',0.05)
INSERT INTO GIAMGIA VALUES (N'GG031',N'Giáng Sinh - Năm mới ','15/12/2022','31/12/2022',0.03)
INSERT INTO GIAMGIA VALUES (N'GG032',N'Tết Nguyên Đán','10/01/2022','27/01/2022',0.05)
INSERT INTO GIAMGIA VALUES (N'GG033',N'Giỗ Tổ Hùng Vương','04/04/2022','11/04/2022',0.03)
INSERT INTO GIAMGIA VALUES (N'GG034',N'Chào mừng 30/4 – 1/5','25/04/2022','01/05/2022',0.03)
INSERT INTO GIAMGIA VALUES (N'GG035',N'Quốc Khánh','25/08/2022','02/09/2022',0.05)
INSERT INTO GIAMGIA VALUES (N'GG036',N'Sinh nhật cửa hàng','06/10/2022','10/10/2022',0.05)
INSERT INTO GIAMGIA VALUES (N'GG037',N'Giáng Sinh - Năm mới ','15/12/2022','31/12/2022',0.03)
INSERT INTO GIAMGIA VALUES (N'GG038',N'Tết Nguyên Đán','10/01/2022','27/01/2022',0.05)
INSERT INTO GIAMGIA VALUES (N'GG039',N'Giỗ Tổ Hùng Vương','04/04/2022','11/04/2022',0.03)
INSERT INTO GIAMGIA VALUES (N'GG040',N'Chào mừng 30/4 – 1/5','25/04/2022','01/05/2022',0.03)

SELECT*FROM GIAMGIA

--INSERT THONG TIN VAO BANG KHO
INSERT INTO KHO VALUES (N'K01',N'59 Phạm Hùng, P5, Q8, TP.HCM',300)
INSERT INTO KHO VALUES (N'K02',N'105 Lý Thái Tổ, P9, Q7, TP.HCM',400)

SELECT*FROM KHO

--INSERT THONG TIN VAO BANG MATHANG
INSERT INTO MATHANG VALUES ('MH001',N'Táo Envy Mỹ',N'Mỹ',210000,'kg','LH001','K01',12,'GG001')
INSERT INTO MATHANG VALUES ('MH002',N'Táo Rockit New Zealand',N'New Zealand',145000,'kg','LH001','K01',14,'GG002')
INSERT INTO MATHANG VALUES ('MH003',N'Táo mật Đài Loan',N'Đài Loan',110000,'kg','LH001','K01',14,'GG003')
INSERT INTO MATHANG VALUES ('MH004',N'Táo đỏ Việt Nam',N'Việt Nam',50000,'kg','LH001','K01',15,'GG004')
INSERT INTO MATHANG VALUES ('MH005',N'Nho xanh Stella Bella Mỹ',N'Mỹ',260000,'kg','LH002','K01',9,'GG005')
INSERT INTO MATHANG VALUES ('MH006',N'Nho Mẫu Đơn Hàn Quốc',N'Hàn Quốc',250000,'kg','LH002','K01',7,'GG006')
INSERT INTO MATHANG VALUES ('MH007',N'Nho đen không hạt',N'Hàn Quốc',160000,'kg','LH002','K01',6,'GG007')
INSERT INTO MATHANG VALUES ('MH008',N'Nho xanh Sweet Globe Úc',N'Úc',330000,'kg','LH002','K01',6,'GG008')
INSERT INTO MATHANG VALUES ('MH009',N'Nho đỏ Việt Nam',N'Việt Nam',70000,'kg','LH002','K01',9,'GG009')
INSERT INTO MATHANG VALUES ('MH010',N'Cam Ruột Đỏ Úc',N'Úc',160000,'kg','LH003','K01',7,'GG010')
INSERT INTO MATHANG VALUES ('MH011',N'Cam Sành ',N'Việt Nam',30000,'kg','LH003','K01',12,'GG011')
INSERT INTO MATHANG VALUES ('MH012',N'Cam Cao Phòng',N'Việt Nam',25000,'kg','LH003','K01',4,'GG012')
INSERT INTO MATHANG VALUES ('MH013',N'Bưởi Da Xanh Tân Triều',N'Việt Nam',110000,'kg','LH004','K01',17,'GG013')
INSERT INTO MATHANG VALUES ('MH014',N'Bưởi Phúc Trạch',N'Việt Nam',45000,'kg','LH004','K01',10,'GG014')
INSERT INTO MATHANG VALUES ('MH015',N'Bưởi Đỏ Thái Lan',N'Thái Lan',50000,'kg','LH004','K01',8,'GG015')
INSERT INTO MATHANG VALUES ('MH016',N'Dưa hấu Ruột Vàng',N'Việt Nam',45000,'kg','LH005','K01',9,'GG016')
INSERT INTO MATHANG VALUES ('MH017',N'Dưa hấu Không Hạt',N'Việt Nam',60000,'kg','LH005','K01',8,'GG017')
INSERT INTO MATHANG VALUES ('MH018',N'Dưa hấu Hắc Mỹ Nhân',N'Việt Nam',50000,'kg','LH005','K01',7,'GG018')
INSERT INTO MATHANG VALUES ('MH019',N'Việt quất New ZeaLand',N'New ZeaLand',1400000,'kg','LH006','K02',18,'GG019')
INSERT INTO MATHANG VALUES ('MH020',N'Việt quất Organic Mỹ',N'Mỹ',1500000,'kg','LH006','K02',12,'GG020')
INSERT INTO MATHANG VALUES ('MH021',N'Việt quất Peru',N'Peru',1500000,'kg','LH006','K02',11,'GG021')
INSERT INTO MATHANG VALUES ('MH022',N'Dâu tây Mỹ',N'Mỹ',460000,'kg','LH007','K02',10,'GG022')
INSERT INTO MATHANG VALUES ('MH023',N'Dâu tây Hàn Quốc ',N'Hàn Quốc ',860000,'kg','LH007','K02',9,'GG023')
INSERT INTO MATHANG VALUES ('MH024',N'Dâu tây Bạch Tuyết',N'Hàn Quốc',830000,'kg','LH007','K02',8,'GG024')
INSERT INTO MATHANG VALUES ('MH025',N'Lê Nam Phi ',N'Nam Phi',100000,'kg','LH008','K02',8,'GG025')
INSERT INTO MATHANG VALUES ('MH026',N'Lê Đường Việt Nam',N'Việt Nam',63000,'kg','LH008','K02',7,'GG026')
INSERT INTO MATHANG VALUES ('MH027',N'Lê Kousui Nhật Bản',N'Nhật Bản',300000,'kg','LH008','K02',6,'GG027')
INSERT INTO MATHANG VALUES ('MH028',N'Cherry Đỏ BrookSide Mỹ ',N'Mỹ',540000,'kg','LH009','K02',7,'GG028')
INSERT INTO MATHANG VALUES ('MH029',N'Cherry Canada',N'Canada',650000,'kg','LH009','K02',9,'GG029')
INSERT INTO MATHANG VALUES ('MH030',N'Cherry Đỏ Washington Mỹ',N'Mỹ',620000,'kg','LH009','K02',8,'GG030')
INSERT INTO MATHANG VALUES ('MH031',N'Cherry New Zealand',N'Zealand',690000,'kg','LH009','K02',10,'GG031')
INSERT INTO MATHANG VALUES ('MH032',N'Cherry Vàng Úc',N'Úc',700000,'kg','LH009','K02',10,'GG032')
INSERT INTO MATHANG VALUES ('MH033',N'Xoài Cát Chu',N'Việt Nam',90000,'kg','LH010','K02',8,'GG033')
INSERT INTO MATHANG VALUES ('MH034',N'Xoài Xanh Đài Loan',N'Đài Loan',65000,'kg','LH010','K02',9,'GG034')
INSERT INTO MATHANG VALUES ('MH035',N'Xoài Hạt Lép ',N'Việt Nam',50000,'kg','LH010','K02',6,'GG035')
INSERT INTO MATHANG VALUES ('MH036',N'Xoài Cát Hòa Lộc',N'Việt Nam',170000,'kg','LH010','K02',4,'GG036')
INSERT INTO MATHANG VALUES ('MH037',N'Xoài Úc',N'Úc',90000,'kg','LH010','K02',6,'GG037')
INSERT INTO MATHANG VALUES ('MH038',N'Xoài Non',N'Việt Nam',45000,'kg','LH010','K02',9,'GG038')
INSERT INTO MATHANG VALUES ('MH039',N'Xoài Thái',N'Thái Lan',85000,'kg','LH010','K02',6,'GG039')
INSERT INTO MATHANG VALUES ('MH040',N'Xoài Tứ Quý',N'Việt Nam',50000,'kg','LH010','K02',10,'GG040')

SELECT*FROM MATHANG

--INSERT THONG TIN VAO BANG NHACUNGCAP
INSERT INTO NHACUNGCAP VALUES ('NCC01',N'Công Ty nhập khẩu trái cây Homefarm','0826582728',N'282 Hoàng Văn Thái, Khương Trung, Thanh Xuân, TP Hà Nội')
INSERT INTO NHACUNGCAP VALUES ('NCC02',N'Công Ty nhập khẩu trái cây V-FOOD Việt Nam','0725678787',N'75A Trần Thái Tông - Cầu Giấy, Hà Nội')
INSERT INTO NHACUNGCAP VALUES ('NCC03',N'Công Ty Hoa Quả Sạch FUJI FRUIT','0253857833',N'24 D7, KĐT Đại Kim - Định Công, P.Đại Kim, Q.Hoàng Mai, Hà Nội')
INSERT INTO NHACUNGCAP VALUES ('NCC04',N'Công Ty nhập khẩu trái cây Saigon Ve Wong','0749362921',N'1707, QL 1A, P. An Phú Đông, Q.12, TP.HCM')

SELECT*FROM NHACUNGCAP

--INSERT THONG TIN VAO BANG NHANVIEN
INSERT INTO NHANVIEN VALUES ('NV001',N'Nguyễn Lan Anh',N'Nữ','0967676634',N'147 Nguyễn Thị Nhỏ, Phường 16, Quận 11, TP.HCM',N'Quản lý cửa hàng','lananhql','462144893')
INSERT INTO NHANVIEN VALUES ('NV002',N'Hoàng Hồng Đức',N'Nam','0784652739',N'36 Gò Công, Phường 13, Quận 5, TP.HCM',N'Bán hàng','hongducbh','272189751')
INSERT INTO NHANVIEN VALUES ('NV003',N'Nguyễn Chí Tài',N'Nam','0886352899',N'5 Đường Cây Keo, Tam Phú, Thủ Đức, TP.HCM',N'Bán hàng','chitaibh','94782925')
INSERT INTO NHANVIEN VALUES ('NV004',N'Trần Thanh Nhã',N'Nữ','0473687883',N'11B QL1A, Hiệp Bình Phước, Thủ Đức, TP.HCM',N'Quản lý kho','thanhnhaqlkho','101804029')
INSERT INTO NHANVIEN VALUES ('NV005',N'Phạm Ngọc Hoàng Lan',N'Nữ','0878686442',N'494 Xô Viết Nghệ Tĩnh, Phường 25, Bình Thạnh, TP.HCM',N'Nhân viên kho','hoanglankho','141833271')
INSERT INTO NHANVIEN VALUES ('NV006',N'Nguyễn Hoàng Sơn',N'Nam','0763787963',N'227 Tạ Quang Bửu, Phường 5, Quận 8, TP.HCM',N'Giao hàng','hoangsongh','530111683')

SELECT*FROM NHANVIEN

--INSERT THONG TIN VAO BANG KHACHHANG
INSERT INTO KHACHHANG VALUES ('KH001',N'Đinh Minh Ánh',N'Nữ','0986545645',N'Xã Hát Môn, Huyện Phúc Thọ, Hà Nội','minhanh','34515777')
INSERT INTO KHACHHANG VALUES ('KH002',N'Dương Minh Châu',N'Nam','0916299747',N'Xã Trung Bình, Huyện Trần Đề, Sóc Trăng','minhchau','94497819')
INSERT INTO KHACHHANG VALUES ('KH003',N'Nguyễn Phương Diệu',N'Nữ','0978424330',N'278 Phạm Ngũ Lão, Quận 1, TP.HCM','phdieu','96949876')
INSERT INTO KHACHHANG VALUES ('KH004',N'Lữ Quốc Bảo Duy',N'Nam','0974212554',N'26 Nguyễn Thị Nghĩa, Bến Thành, Quận 1, TP.HCM','baoduy99','21110961')
INSERT INTO KHACHHANG VALUES ('KH005',N'Nguyễn Mai Kỳ Duyên',N'Nữ','0981447300',N'45 Đinh Tiên Hoàng, Đa Kao, Quận 1, TP.HCM','kyduyennn','61933311')
INSERT INTO KHACHHANG VALUES ('KH006',N'Võ Thị Thái Hà',N'Nữ','0971535949',N'68 Vĩnh Lưu, Đông Hải 1, Hải An, Hải Phòng','thaihaha','35966206')
INSERT INTO KHACHHANG VALUES ('KH007',N'Nguyễn Thị Kim Hạnh',N'Nữ','0965535949',N'116 Ngọc Thuỵ, Ngọc Thụy, Long Biên, Hà Nội','nguyenhanh','71220726')
INSERT INTO KHACHHANG VALUES ('KH008',N'Phạm Ngọc Hân',N'Nữ','0971040557',N'25 Nguyễn Đình Tứ, Hoà An, Liên Chiểu, Đà Nẵng ','hanpham','13466528')
INSERT INTO KHACHHANG VALUES ('KH009',N'Lê Phúc Hậu',N'Nam','0976665121',N'78 Lê Quý Đôn, Quận 3, TP.HCM','lephuchau1207','58703535')
INSERT INTO KHACHHANG VALUES ('KH010',N'Huỳnh Thị An Hòa',N'Nữ','0961502572',N'76 An Dương, Yên Phụ, Tây Hồ, Hà Nội ','anhoa03','411005')
INSERT INTO KHACHHANG VALUES ('KH011',N'Lữ Quốc Hùng',N'Nam','0372921961',N'57 Nguyễn Hữu Thọ, Hòa Thuận Nam, Hải Châu, Đà Nẵng','quochunglu','95932679')
INSERT INTO KHACHHANG VALUES ('KH012',N'Trần Lê Hoàng Kim',N'Nữ','0328112181',N'16 P.Nguyễn Như Đổ, Văn Miếu, Đống Đa, Hà Nội ','hoangkim990','30926559')
INSERT INTO KHACHHANG VALUES ('KH013',N'Phùng Mai Linh',N'Nữ','0356751157',N'30 Thành Thái, Phường 14, Quận 10, TP.HCM','mailinh','46312708')
INSERT INTO KHACHHANG VALUES ('KH014',N'Nguyễn Thị Thúy Nga',N'Nữ','0378537735',N'78 P. Giảng Võ, Kim Mã, Đống Đa, Hà Nội ','thuynganguyen','52884058')
INSERT INTO KHACHHANG VALUES ('KH015',N'Huỳnh Hồng Nguyên',N'Nữ','0364581851',N'34 Nguyễn Hữu Thọ, Hòa Thuận Nam, Hải Châu, Đà Nẵng ','hongnguyen','43642479')
INSERT INTO KHACHHANG VALUES ('KH016',N'Nguyễn Thị Huyền Nhi',N'Nữ','0832946456',N'Ngõ 95 Đ. Gia Thượng, Thượng Thanh, Long Biên, Hà Nội','huyennhi','33951821')
INSERT INTO KHACHHANG VALUES ('KH017',N'Văn Thảo Nhi',N'Nữ','0396182782',N'964 Phạm Văn Đồng, Thủ Đức, TP.HCM','vannhi','56271497')
INSERT INTO KHACHHANG VALUES ('KH018',N'Phạm Hiểu Phương',N'Nam','0366371871',N'55 P. Hàng Bún, Quán Thánh, Ba Đình, Hà Nội','phamphuong','40865772')
INSERT INTO KHACHHANG VALUES ('KH019',N'Nguyễn Trung Hiếu',N'Nam','0378564645',N'68 Hiệp Bình, Hiệp Bình Phước, Thủ Đức, TP.HCM','trunghieu','23509052')
INSERT INTO KHACHHANG VALUES ('KH020',N'Phạm Thị Anh Thư',N'Nữ','0354097790',N'120 Hoàng Minh Thảo, Hoà Khánh Nam, Liên Chiểu, Đà Nẵng ','anhthupham74','96164856')
INSERT INTO KHACHHANG VALUES ('KH021',N'Hồ Trần Anh Thư',N'Nữ','0362807087',N'197 Thanh Am, Thượng Thanh, Long Biên, Hà Nội','anhthuhotran','15182363')
INSERT INTO KHACHHANG VALUES ('KH022',N'Hoàng Thái',N'Nam','0372206026',N'56 Trần Hưng Đạo, Đồng Hới, Quảng Bình','hoangthaid7','35574102')
INSERT INTO KHACHHANG VALUES ('KH023',N'Nguyễn Trần Anh Đức',N'Nam','0383056956',N'10A Lê Hồng Phong, Đằng Hải, Hải An, Hải Phòng ','anhduclala','41084993')
INSERT INTO KHACHHANG VALUES ('KH024',N'Lê Thị Thùy Trang',N'Nữ','0983858711',N'Ngõ 81 Đức Giang, Đức Giang, Long Biên, Hà Nội','thuytrangle','85204425')
INSERT INTO KHACHHANG VALUES ('KH025',N'Nguyễn Huyền Trâm',N'Nữ','0337037790',N'56/73 Hồng Đức, Tây Hồ, Hà Nội','huyentram022','63938606')
INSERT INTO KHACHHANG VALUES ('KH026',N'Phạm Anh Tài',N'Nam','0967442747',N'206 Nguyễn Văn Đậu, P.11, Bình Thạnh, TP.HCM','anhtaipham','92908761')
INSERT INTO KHACHHANG VALUES ('KH027',N'Nguyễn Quang Đăng',N'Nam','0967233011',N'Đ. 602, Hoà Sơn, Hòa Vang, Đà Nẵng','wangdang','70589333')
INSERT INTO KHACHHANG VALUES ('KH028',N'Lê Thanh Tùng',N'Nam','0971113533',N'35 Ngách 268/21, Ngọc Thụy, Hà Nội','thantung','5836407')
INSERT INTO KHACHHANG VALUES ('KH029',N'Triệu Yến Vy',N'Nữ','0976004484',N'16 QL13, Hiệp Bình Phước, Thủ Đức, TP.HCM','yennvyy','57759425')
INSERT INTO KHACHHANG VALUES ('KH030',N'Nguyễn Trúc Ly',N'Nữ','0387687901',N'12 KDT Anh Dũng 7, Dương Kinh, Hải Phòng','truclyly2306','57101416')

SELECT*FROM KHACHHANG

--INSERT THONG TIN VAO BANG DONHANG
INSERT INTO DONHANG VALUES ('DH001','KH001',N'Thẻ','10/01/2022','13/01/2022',N'Xã Hát Môn, Huyện Phúc Thọ, Hà Nội',N'Đã TT',N'Đã Giao')
INSERT INTO DONHANG VALUES ('DH002','KH002',N'Tiền mặt','10/01/2022','13/01/2022',N'Xã Trung Bình, Huyện Trần Đề, Sóc Trăng',N'Đã TT',N'Đã Giao')
INSERT INTO DONHANG VALUES ('DH003','KH003',N'Thẻ','10/01/2022','13/01/2022',N'278 Phạm Ngũ Lão, Quận 1, TP.HCM',N'Đã TT',N'Đã Giao')
INSERT INTO DONHANG VALUES ('DH004','KH004',N'Tiền mặt','10/01/2022','13/01/2022',N'26 Nguyễn Thị Nghĩa, Bến Thành, Quận 1, TP.HCM',N'Đã TT',N'Đã Giao')
INSERT INTO DONHANG VALUES ('DH005','KH005',N'Thẻ','06/02/2022','09/02/2022',N'45 Đinh Tiên Hoàng, Đa Kao, Quận 1, TP.HCM',N'Đã TT',N'Đã Giao')
INSERT INTO DONHANG VALUES ('DH006','KH006',N'Tiền mặt','06/02/2022','09/02/2022',N'68 Vĩnh Lưu, Đông Hải 1, Hải An, Hải Phòng',N'Đã TT',N'Đã Giao')
INSERT INTO DONHANG VALUES ('DH007','KH007',N'Tiền mặt','06/02/2022','09/02/2022',N'116 Ngọc Thuỵ, Ngọc Thụy, Long Biên, Hà Nội',N'Đã TT',N'Đã Giao')
INSERT INTO DONHANG VALUES ('DH008','KH008',N'Thẻ','11/02/2022','14/02/2022',N'25 Nguyễn Đình Tứ, Hoà An, Liên Chiểu, Đà Nẵng ',N'Đã TT',N'Đã Giao')
INSERT INTO DONHANG VALUES ('DH009','KH009',N'Tiền mặt','13/02/2022','16/02/2022',N'78 Lê Quý Đôn, Quận 3, TP.HCM',N'Đã TT',N'Đã Giao')
INSERT INTO DONHANG VALUES ('DH010','KH010',N'Thẻ','15/02/2022','18/02/2022',N'76 An Dương, Yên Phụ, Tây Hồ, Hà Nội ',N'Đã TT',N'Đã Giao')
INSERT INTO DONHANG VALUES ('DH011','KH011',N'Thẻ','15/02/2022','18/02/2022',N'57 Nguyễn Hữu Thọ, Hòa Thuận Nam, Hải Châu, Đà Nẵng',N'Đã TT',N'Đã Giao')
INSERT INTO DONHANG VALUES ('DH012','KH012',N'Tiền mặt','12/03/2022','15/03/2022',N'16 P.Nguyễn Như Đổ, Văn Miếu, Đống Đa, Hà Nội ',N'Đã TT',N'Đã Giao')
INSERT INTO DONHANG VALUES ('DH013','KH013',N'Thẻ','12/03/2022','15/03/2022',N'30 Thành Thái, Phường 14, Quận 10, TP.HCM',N'Đã TT',N'Đã Giao')
INSERT INTO DONHANG VALUES ('DH014','KH014',N'Tiền mặt','12/03/2022','15/03/2022',N'78 P. Giảng Võ, Kim Mã, Đống Đa, Hà Nội ',N'Đã TT',N'Đã Giao')
INSERT INTO DONHANG VALUES ('DH015','KH015',N'Thẻ','12/03/2022','15/03/2022',N'34 Nguyễn Hữu Thọ, Hòa Thuận Nam, Hải Châu, Đà Nẵng ',N'Đã TT',N'Đã Giao')
INSERT INTO DONHANG VALUES ('DH016','KH016',N'Thẻ','12/03/2022','15/03/2022',N'Ngõ 95 Đ. Gia Thượng, Thượng Thanh, Long Biên, Hà Nội',N'Đã TT',N'Đã Giao')
INSERT INTO DONHANG VALUES ('DH017','KH017',N'Tiền mặt','16/03/2022','19/03/2022',N'964 Phạm Văn Đồng, Thủ Đức, TP.HCM',N'Đã TT',N'Đã Giao')
INSERT INTO DONHANG VALUES ('DH018','KH018',N'Thẻ','18/03/2022','21/03/2022',N'55 P. Hàng Bún, Quán Thánh, Ba Đình, Hà Nội',N'Đã TT',N'Đã Giao')
INSERT INTO DONHANG VALUES ('DH019','KH019',N'Tiền mặt','16/05/2022','19/05/2022',N'68 Hiệp Bình, Hiệp Bình Phước, Thủ Đức, TP.HCM',N'Đã TT',N'Đã Giao')
INSERT INTO DONHANG VALUES ('DH020','KH020',N'Thẻ','06/06/2022','09/06/2022',N'120 Hoàng Minh Thảo, Hoà Khánh Nam, Liên Chiểu, Đà Nẵng ',N'Đã TT',N'Đã Giao')
INSERT INTO DONHANG VALUES ('DH021','KH021',N'Tiền mặt','28/06/2022','30/06/2022',N'197 Thanh Am, Thượng Thanh, Long Biên, Hà Nội',N'Đã TT',N'Đã Giao')
INSERT INTO DONHANG VALUES ('DH022','KH022',N'Thẻ','13/07/2022','16/07/2022',N'56 Trần Hưng Đạo, Đồng Hới, Quảng Bình',N'Đã TT',N'Đã Giao')
INSERT INTO DONHANG VALUES ('DH023','KH023',N'Tiền mặt','07/08/2022','10/08/2022',N'10A Lê Hồng Phong, Đằng Hải, Hải An, Hải Phòng ',N'Đã TT',N'Đã Giao')
INSERT INTO DONHANG VALUES ('DH024','KH024',N'Thẻ','09/08/2022','12/08/2022',N'Ngõ 81 Đức Giang, Đức Giang, Long Biên, Hà Nội',N'Đã TT',N'Đã Giao')
INSERT INTO DONHANG VALUES ('DH025','KH025',N'Tiền mặt','09/09/2022','12/09/2022',N'56/73 Hồng Đức, Tây Hồ, Hà Nội',N'Đã TT',N'Đã Giao')
INSERT INTO DONHANG VALUES ('DH026','KH026',N'Tiền mặt','31/10/2022','3/11/2022',N'206 Nguyễn Văn Đậu, P.11, Bình Thạnh, TP.HCM',N'Đã TT',N'Đã Giao')
INSERT INTO DONHANG VALUES ('DH027','KH027',N'Thẻ','12/11/2022','15/11/2022',N'Đ. 602, Hoà Sơn, Hòa Vang, Đà Nẵng',N'Đã TT',N'Đã Giao')
INSERT INTO DONHANG VALUES ('DH028','KH028',N'Tiền mặt','12/11/2022','15/11/2022',N'35 Ngách 268/21, Ngọc Thụy, Hà Nội',N'Đã TT',N'Đã Giao')
INSERT INTO DONHANG VALUES ('DH029','KH029',N'Thẻ','13/11/2022','16/11/2022',N'16 QL13, Hiệp Bình Phước, Thủ Đức, TP.HCM',N'Đã TT',N'Đã Giao')
INSERT INTO DONHANG VALUES ('DH030','KH030',N'Thẻ','22/12/2022','25/12/2022',N'12 KDT Anh Dũng 7, Dương Kinh, Hải Phòng',N'Đã TT',N'Đã Giao')
INSERT INTO DONHANG VALUES ('DH031','KH018',N'Thẻ','23/12/2022','26/12/2022',N'55 P. Hàng Bún, Quán Thánh, Ba Đình, Hà Nội',N'Đã TT',N'Đã Giao')
INSERT INTO DONHANG VALUES ('DH032','KH023',N'Tiền mặt','23/12/2022','26/12/2022',N'10A Lê Hồng Phong, Đằng Hải, Hải An, Hải Phòng ',N'Đã TT',N'Đã Giao')
INSERT INTO DONHANG VALUES ('DH033','KH001',N'Tiền mặt','23/12/2022',NULL,'Xã Hát Môn, Huyện Phúc Thọ, Hà Nội',N'Chưa TT',N'Đang Giao')
INSERT INTO DONHANG VALUES ('DH034','KH005',N'Thẻ','24/12/2022',NULL,'45 Đinh Tiên Hoàng, Đa Kao, Quận 1, TP.HCM',N'Đã TT',N'Đang Giao')
INSERT INTO DONHANG VALUES ('DH035','KH026',N'Tiền mặt','24/12/2022',NULL,'206 Nguyễn Văn Đậu, P.11, Bình Thạnh, TP.HCM',N'Chưa TT',N'Đang Giao')

SELECT*FROM DONHANG

--INSERT THONG TIN VAO BANG CHITIETDONHANG
INSERT INTO CHITIETDONHANG VALUES ('DH001','MH002',2,145000,290000,'GG002')
INSERT INTO CHITIETDONHANG VALUES ('DH001','MH003',3,110000,330000,'GG003')
INSERT INTO CHITIETDONHANG VALUES ('DH001','MH007',4,160000,640000,'GG007')
INSERT INTO CHITIETDONHANG VALUES ('DH002','MH008',5,330000,1650000,'GG008')
INSERT INTO CHITIETDONHANG VALUES ('DH002','MH010',2,160000,320000,'GG010')
INSERT INTO CHITIETDONHANG VALUES ('DH003','MH011',3,30000,90000,'GG011')
INSERT INTO CHITIETDONHANG VALUES ('DH003','MH020',8,1500000,12000000,'GG020')
INSERT INTO CHITIETDONHANG VALUES ('DH003','MH030',6,620000,3720000,'GG030')
INSERT INTO CHITIETDONHANG VALUES ('DH004','MH029',5,650000,3250000,'GG029')
INSERT INTO CHITIETDONHANG VALUES ('DH005','MH002',4,145000,580000,'GG002')
INSERT INTO CHITIETDONHANG VALUES ('DH005','MH019',4,1400000,5600000,'GG019')
INSERT INTO CHITIETDONHANG VALUES ('DH005','MH027',7,300000,2100000,'GG027')
INSERT INTO CHITIETDONHANG VALUES ('DH006','MH001',4,210000,840000,'GG001')
INSERT INTO CHITIETDONHANG VALUES ('DH006','MH009',2,70000,140000,'GG009')
INSERT INTO CHITIETDONHANG VALUES ('DH007','MH010',9,160000,1440000,'GG010')
INSERT INTO CHITIETDONHANG VALUES ('DH007','MH011',10,30000,300000,'GG011')
INSERT INTO CHITIETDONHANG VALUES ('DH007','MH012',3,25000,75000,'GG012')
INSERT INTO CHITIETDONHANG VALUES ('DH008','MH013',6,110000,660000,'GG013')
INSERT INTO CHITIETDONHANG VALUES ('DH009','MH014',3,45000,135000,'GG014')
INSERT INTO CHITIETDONHANG VALUES ('DH009','MH015',7,50000,350000,'GG015')
INSERT INTO CHITIETDONHANG VALUES ('DH010','MH016',3,45000,135000,'GG016')
INSERT INTO CHITIETDONHANG VALUES ('DH010','MH017',5,60000,300000,'GG017')
INSERT INTO CHITIETDONHANG VALUES ('DH011','MH018',6,50000,300000,'GG018')
INSERT INTO CHITIETDONHANG VALUES ('DH012','MH019',4,1400000,5600000,'GG019')
INSERT INTO CHITIETDONHANG VALUES ('DH013','MH020',3,1500000,4500000,'GG020')
INSERT INTO CHITIETDONHANG VALUES ('DH013','MH021',3,1500000,4500000,'GG021')
INSERT INTO CHITIETDONHANG VALUES ('DH013','MH022',7,460000,3220000,'GG022')
INSERT INTO CHITIETDONHANG VALUES ('DH014','MH023',3,860000,2580000,'GG023')
INSERT INTO CHITIETDONHANG VALUES ('DH014','MH024',7,830000,5810000,'GG024')
INSERT INTO CHITIETDONHANG VALUES ('DH015','MH025',3,100000,300000,'GG025')
INSERT INTO CHITIETDONHANG VALUES ('DH015','MH026',1,63000,63000,'GG026')
INSERT INTO CHITIETDONHANG VALUES ('DH015','MH027',1,300000,300000,'GG027')
INSERT INTO CHITIETDONHANG VALUES ('DH016','MH028',3,540000,1620000,'GG028')
INSERT INTO CHITIETDONHANG VALUES ('DH016','MH029',4,650000,2600000,'GG029')
INSERT INTO CHITIETDONHANG VALUES ('DH017','MH030',7,620000,4340000,'GG030')
INSERT INTO CHITIETDONHANG VALUES ('DH017','MH031',4,690000,2760000,'GG031')
INSERT INTO CHITIETDONHANG VALUES ('DH017','MH032',9,700000,6300000,'GG032')
INSERT INTO CHITIETDONHANG VALUES ('DH017','MH033',9,90000,810000,'GG033')
INSERT INTO CHITIETDONHANG VALUES ('DH018','MH034',6,65000,390000,'GG034')
INSERT INTO CHITIETDONHANG VALUES ('DH018','MH035',3,50000,150000,'GG035')
INSERT INTO CHITIETDONHANG VALUES ('DH019','MH036',2,170000,340000,'GG036')
INSERT INTO CHITIETDONHANG VALUES ('DH019','MH037',5,90000,450000,'GG037')
INSERT INTO CHITIETDONHANG VALUES ('DH019','MH038',5,45000,225000,'GG038')
INSERT INTO CHITIETDONHANG VALUES ('DH020','MH039',6,85000,510000,'GG039')
INSERT INTO CHITIETDONHANG VALUES ('DH021','MH040',4,50000,200000,'GG040')
INSERT INTO CHITIETDONHANG VALUES ('DH021','MH001',3,210000,630000,'GG001')
INSERT INTO CHITIETDONHANG VALUES ('DH022','MH002',2,145000,290000,'GG002')
INSERT INTO CHITIETDONHANG VALUES ('DH022','MH003',1,110000,110000,'GG003')
INSERT INTO CHITIETDONHANG VALUES ('DH023','MH004',2,50000,100000,'GG004')
INSERT INTO CHITIETDONHANG VALUES ('DH023','MH005',3,260000,780000,'GG005')
INSERT INTO CHITIETDONHANG VALUES ('DH024','MH006',4,250000,1000000,'GG006')
INSERT INTO CHITIETDONHANG VALUES ('DH025','MH007',5,160000,800000,'GG007')
INSERT INTO CHITIETDONHANG VALUES ('DH025','MH008',4,330000,1320000,'GG008')
INSERT INTO CHITIETDONHANG VALUES ('DH026','MH009',7,70000,490000,'GG009')
INSERT INTO CHITIETDONHANG VALUES ('DH026','MH010',8,160000,1280000,'GG010')
INSERT INTO CHITIETDONHANG VALUES ('DH026','MH011',6,30000,180000,'GG011')
INSERT INTO CHITIETDONHANG VALUES ('DH027','MH012',5,25000,125000,'GG012')
INSERT INTO CHITIETDONHANG VALUES ('DH028','MH013',4,110000,440000,'GG013')
INSERT INTO CHITIETDONHANG VALUES ('DH029','MH014',3,45000,135000,'GG014')
INSERT INTO CHITIETDONHANG VALUES ('DH029','MH015',4,50000,200000,'GG015')
INSERT INTO CHITIETDONHANG VALUES ('DH030','MH030',5,620000,3100000,'GG030')
INSERT INTO CHITIETDONHANG VALUES ('DH031','MH031',6,690000,4140000,'GG031')
INSERT INTO CHITIETDONHANG VALUES ('DH031','MH032',9,700000,6300000,'GG032')
INSERT INTO CHITIETDONHANG VALUES ('DH032','MH033',8,90000,720000,'GG033')
INSERT INTO CHITIETDONHANG VALUES ('DH032','MH034',6,65000,390000,'GG034')
INSERT INTO CHITIETDONHANG VALUES ('DH033','MH035',5,50000,250000,'GG035')
INSERT INTO CHITIETDONHANG VALUES ('DH033','MH036',2,170000,340000,'GG036')
INSERT INTO CHITIETDONHANG VALUES ('DH033','MH037',3,90000,270000,'GG037')
INSERT INTO CHITIETDONHANG VALUES ('DH034','MH038',3,45000,135000,'GG038')
INSERT INTO CHITIETDONHANG VALUES ('DH035','MH039',4,85000,340000,'GG039')

SELECT*FROM CHITIETDONHANG

--INSERT THONG TIN VAO BANG PHIEUNHAP
INSERT INTO PHIEUNHAP VALUES ('PN001','NCC01','NV004','09/01/2022')
INSERT INTO PHIEUNHAP VALUES ('PN002','NCC03','NV004','07/02/2022')
INSERT INTO PHIEUNHAP VALUES ('PN003','NCC01','NV005','15/02/2022')
INSERT INTO PHIEUNHAP VALUES ('PN004','NCC04','NV004','13/03/2022')
INSERT INTO PHIEUNHAP VALUES ('PN005','NCC03','NV004','02/05/2022')
INSERT INTO PHIEUNHAP VALUES ('PN006','NCC02','NV005','05/06/2022')
INSERT INTO PHIEUNHAP VALUES ('PN007','NCC01','NV004','07/07/2022')
INSERT INTO PHIEUNHAP VALUES ('PN008','NCC04','NV004','05/09/2022')
INSERT INTO PHIEUNHAP VALUES ('PN009','NCC02','NV005','24/12/2022')
INSERT INTO PHIEUNHAP VALUES ('PN010','NCC04','NV005','24/12/2022')

SELECT*FROM PHIEUNHAP

--INSERT THONG TIN VAO BANG CHITIETPHIEUNHAP
INSERT INTO CHITIETPHIEUNHAP VALUES ('PN001',N'MH001',10,189000)
INSERT INTO CHITIETPHIEUNHAP VALUES ('PN001',N'MH002',5,130500)
INSERT INTO CHITIETPHIEUNHAP VALUES ('PN001',N'MH003',5,99000)
INSERT INTO CHITIETPHIEUNHAP VALUES ('PN002',N'MH004',7,45000)
INSERT INTO CHITIETPHIEUNHAP VALUES ('PN002',N'MH005',10,234000)
INSERT INTO CHITIETPHIEUNHAP VALUES ('PN002',N'MH006',6,225000)
INSERT INTO CHITIETPHIEUNHAP VALUES ('PN002',N'MH007',8,144000)
INSERT INTO CHITIETPHIEUNHAP VALUES ('PN003',N'MH008',8,297000)
INSERT INTO CHITIETPHIEUNHAP VALUES ('PN003',N'MH009',7,63000)
INSERT INTO CHITIETPHIEUNHAP VALUES ('PN004',N'MH010',7,144000)
INSERT INTO CHITIETPHIEUNHAP VALUES ('PN004',N'MH011',7,27000)
INSERT INTO CHITIETPHIEUNHAP VALUES ('PN004',N'MH012',10,22500)
INSERT INTO CHITIETPHIEUNHAP VALUES ('PN005',N'MH013',10,100000)
INSERT INTO CHITIETPHIEUNHAP VALUES ('PN005',N'MH014',6,40500)
INSERT INTO CHITIETPHIEUNHAP VALUES ('PN006',N'MH015',8,45000)
INSERT INTO CHITIETPHIEUNHAP VALUES ('PN006',N'MH016',9,40500)
INSERT INTO CHITIETPHIEUNHAP VALUES ('PN006',N'MH017',7,54000)
INSERT INTO CHITIETPHIEUNHAP VALUES ('PN006',N'MH018',10,45000)
INSERT INTO CHITIETPHIEUNHAP VALUES ('PN006',N'MH019',10,1260000)
INSERT INTO CHITIETPHIEUNHAP VALUES ('PN007',N'MH020',5,1350000)
INSERT INTO CHITIETPHIEUNHAP VALUES ('PN007',N'MH021',5,1300000)
INSERT INTO CHITIETPHIEUNHAP VALUES ('PN007',N'MH022',6,410000)
INSERT INTO CHITIETPHIEUNHAP VALUES ('PN007',N'MH023',8,770000)
INSERT INTO CHITIETPHIEUNHAP VALUES ('PN007',N'MH024',8,747000)
INSERT INTO CHITIETPHIEUNHAP VALUES ('PN007',N'MH025',5,90000)
INSERT INTO CHITIETPHIEUNHAP VALUES ('PN008',N'MH026',5,56700)
INSERT INTO CHITIETPHIEUNHAP VALUES ('PN008',N'MH027',6,270000)
INSERT INTO CHITIETPHIEUNHAP VALUES ('PN008',N'MH028',10,486000)
INSERT INTO CHITIETPHIEUNHAP VALUES ('PN008',N'MH029',8,585000)
INSERT INTO CHITIETPHIEUNHAP VALUES ('PN008',N'MH030',5,558000)
INSERT INTO CHITIETPHIEUNHAP VALUES ('PN008',N'MH031',8,621000)
INSERT INTO CHITIETPHIEUNHAP VALUES ('PN009',N'MH032',9,630000)
INSERT INTO CHITIETPHIEUNHAP VALUES ('PN009',N'MH033',10,81000)
INSERT INTO CHITIETPHIEUNHAP VALUES ('PN009',N'MH034',10,58000)
INSERT INTO CHITIETPHIEUNHAP VALUES ('PN009',N'MH035',6,43000)
INSERT INTO CHITIETPHIEUNHAP VALUES ('PN009',N'MH036',6,153000)
INSERT INTO CHITIETPHIEUNHAP VALUES ('PN010',N'MH037',8,80000)
INSERT INTO CHITIETPHIEUNHAP VALUES ('PN010',N'MH038',9,40500)
INSERT INTO CHITIETPHIEUNHAP VALUES ('PN010',N'MH039',7,76500)
INSERT INTO CHITIETPHIEUNHAP VALUES ('PN010',N'MH040',9,43100)
INSERT INTO CHITIETPHIEUNHAP VALUES ('PN010',N'MH023',8,770000)
INSERT INTO CHITIETPHIEUNHAP VALUES ('PN010',N'MH010',7,144000)
INSERT INTO CHITIETPHIEUNHAP VALUES ('PN010',N'MH011',7,27000)
INSERT INTO CHITIETPHIEUNHAP VALUES ('PN010',N'MH012',6,22500)
INSERT INTO CHITIETPHIEUNHAP VALUES ('PN010',N'MH013',8,100000)
INSERT INTO CHITIETPHIEUNHAP VALUES ('PN010',N'MH014',7,40500)

SELECT*FROM CHITIETPHIEUNHAP

--INSERT THONG TIN VAO BANG PHIEUXUAT
INSERT INTO PHIEUXUAT VALUES ('PX001','NV004','10/01/2022')
INSERT INTO PHIEUXUAT VALUES ('PX002','NV005','10/01/2022')
INSERT INTO PHIEUXUAT VALUES ('PX003','NV005','10/01/2022')
INSERT INTO PHIEUXUAT VALUES ('PX004','NV004','10/01/2022')
INSERT INTO PHIEUXUAT VALUES ('PX005','NV004','06/02/2022')
INSERT INTO PHIEUXUAT VALUES ('PX006','NV005','06/02/2022')
INSERT INTO PHIEUXUAT VALUES ('PX007','NV005','06/02/2022')
INSERT INTO PHIEUXUAT VALUES ('PX008','NV004','11/02/2022')
INSERT INTO PHIEUXUAT VALUES ('PX009','NV005','13/02/2022')
INSERT INTO PHIEUXUAT VALUES ('PX010','NV005','15/02/2022')
INSERT INTO PHIEUXUAT VALUES ('PX011','NV004','15/02/2022')
INSERT INTO PHIEUXUAT VALUES ('PX012','NV005','12/03/2022')
INSERT INTO PHIEUXUAT VALUES ('PX013','NV005','12/03/2022')
INSERT INTO PHIEUXUAT VALUES ('PX014','NV005','12/03/2022')
INSERT INTO PHIEUXUAT VALUES ('PX015','NV004','12/03/2022')
INSERT INTO PHIEUXUAT VALUES ('PX016','NV005','12/03/2022')
INSERT INTO PHIEUXUAT VALUES ('PX017','NV005','16/03/2022')
INSERT INTO PHIEUXUAT VALUES ('PX018','NV005','18/03/2022')
INSERT INTO PHIEUXUAT VALUES ('PX019','NV005','16/05/2022')
INSERT INTO PHIEUXUAT VALUES ('PX020','NV005','06/06/2022')
INSERT INTO PHIEUXUAT VALUES ('PX021','NV005','28/06/2022')
INSERT INTO PHIEUXUAT VALUES ('PX022','NV005','13/07/2022')
INSERT INTO PHIEUXUAT VALUES ('PX023','NV005','07/08/2022')
INSERT INTO PHIEUXUAT VALUES ('PX024','NV005','09/08/2022')
INSERT INTO PHIEUXUAT VALUES ('PX025','NV004','09/09/2022')
INSERT INTO PHIEUXUAT VALUES ('PX026','NV005','31/10/2022')
INSERT INTO PHIEUXUAT VALUES ('PX027','NV005','12/11/2022')
INSERT INTO PHIEUXUAT VALUES ('PX028','NV004','12/11/2022')
INSERT INTO PHIEUXUAT VALUES ('PX029','NV005','13/11/2022')
INSERT INTO PHIEUXUAT VALUES ('PX030','NV005','22/12/2022')
INSERT INTO PHIEUXUAT VALUES ('PX031','NV004','23/12/2022')
INSERT INTO PHIEUXUAT VALUES ('PX032','NV005','23/12/2022')
INSERT INTO PHIEUXUAT VALUES ('PX033','NV005','23/12/2022')
INSERT INTO PHIEUXUAT VALUES ('PX034','NV004','24/12/2022')
INSERT INTO PHIEUXUAT VALUES ('PX035','NV004','24/12/2022')

SELECT*FROM PHIEUXUAT

--INSERT THONG TIN VAO BANG CHITIETPHIEUXUAT
INSERT INTO CHITIETPHIEUXUAT VALUES ('PX001','DH001','MH002',2,145000)
INSERT INTO CHITIETPHIEUXUAT VALUES ('PX001','DH001','MH003',3,110000)
INSERT INTO CHITIETPHIEUXUAT VALUES ('PX001','DH001','MH007',4,160000)
INSERT INTO CHITIETPHIEUXUAT VALUES ('PX002','DH002','MH008',5,330000)
INSERT INTO CHITIETPHIEUXUAT VALUES ('PX002','DH002','MH010',2,160000)
INSERT INTO CHITIETPHIEUXUAT VALUES ('PX003','DH003','MH011',3,30000)
INSERT INTO CHITIETPHIEUXUAT VALUES ('PX003','DH003','MH020',8,1500000)
INSERT INTO CHITIETPHIEUXUAT VALUES ('PX003','DH003','MH030',6,620000)
INSERT INTO CHITIETPHIEUXUAT VALUES ('PX004','DH004','MH029',5,650000)
INSERT INTO CHITIETPHIEUXUAT VALUES ('PX005','DH005','MH002',4,145000)
INSERT INTO CHITIETPHIEUXUAT VALUES ('PX005','DH005','MH019',4,1400000)
INSERT INTO CHITIETPHIEUXUAT VALUES ('PX005','DH005','MH027',7,300000)
INSERT INTO CHITIETPHIEUXUAT VALUES ('PX006','DH006','MH001',4,210000)
INSERT INTO CHITIETPHIEUXUAT VALUES ('PX006','DH006','MH009',2,70000)
INSERT INTO CHITIETPHIEUXUAT VALUES ('PX007','DH007','MH010',9,160000)
INSERT INTO CHITIETPHIEUXUAT VALUES ('PX007','DH007','MH011',10,30000)
INSERT INTO CHITIETPHIEUXUAT VALUES ('PX007','DH007','MH012',3,25000)
INSERT INTO CHITIETPHIEUXUAT VALUES ('PX008','DH008','MH013',6,110000)
INSERT INTO CHITIETPHIEUXUAT VALUES ('PX009','DH009','MH014',3,45000)
INSERT INTO CHITIETPHIEUXUAT VALUES ('PX009','DH009','MH015',7,50000)
INSERT INTO CHITIETPHIEUXUAT VALUES ('PX010','DH010','MH016',3,45000)
INSERT INTO CHITIETPHIEUXUAT VALUES ('PX010','DH010','MH017',5,60000)
INSERT INTO CHITIETPHIEUXUAT VALUES ('PX011','DH011','MH018',6,50000)
INSERT INTO CHITIETPHIEUXUAT VALUES ('PX012','DH012','MH019',4,1400000)
INSERT INTO CHITIETPHIEUXUAT VALUES ('PX013','DH013','MH020',3,1500000)
INSERT INTO CHITIETPHIEUXUAT VALUES ('PX013','DH013','MH021',3,1500000)
INSERT INTO CHITIETPHIEUXUAT VALUES ('PX013','DH013','MH022',7,460000)
INSERT INTO CHITIETPHIEUXUAT VALUES ('PX014','DH014','MH023',3,860000)
INSERT INTO CHITIETPHIEUXUAT VALUES ('PX014','DH014','MH024',7,830000)
INSERT INTO CHITIETPHIEUXUAT VALUES ('PX015','DH015','MH025',3,100000)
INSERT INTO CHITIETPHIEUXUAT VALUES ('PX015','DH015','MH026',1,63000)
INSERT INTO CHITIETPHIEUXUAT VALUES ('PX015','DH015','MH027',1,300000)
INSERT INTO CHITIETPHIEUXUAT VALUES ('PX016','DH016','MH028',3,540000)
INSERT INTO CHITIETPHIEUXUAT VALUES ('PX016','DH016','MH029',4,650000)
INSERT INTO CHITIETPHIEUXUAT VALUES ('PX017','DH017','MH030',7,620000)
INSERT INTO CHITIETPHIEUXUAT VALUES ('PX017','DH017','MH031',4,690000)
INSERT INTO CHITIETPHIEUXUAT VALUES ('PX017','DH017','MH032',9,700000)
INSERT INTO CHITIETPHIEUXUAT VALUES ('PX017','DH017','MH033',9,90000)
INSERT INTO CHITIETPHIEUXUAT VALUES ('PX018','DH018','MH034',6,65000)
INSERT INTO CHITIETPHIEUXUAT VALUES ('PX018','DH018','MH035',3,50000)
INSERT INTO CHITIETPHIEUXUAT VALUES ('PX019','DH019','MH036',2,170000)
INSERT INTO CHITIETPHIEUXUAT VALUES ('PX019','DH019','MH037',5,90000)
INSERT INTO CHITIETPHIEUXUAT VALUES ('PX019','DH019','MH038',5,45000)
INSERT INTO CHITIETPHIEUXUAT VALUES ('PX020','DH020','MH039',6,85000)
INSERT INTO CHITIETPHIEUXUAT VALUES ('PX021','DH021','MH040',4,50000)
INSERT INTO CHITIETPHIEUXUAT VALUES ('PX021','DH021','MH001',3,210000)
INSERT INTO CHITIETPHIEUXUAT VALUES ('PX022','DH022','MH002',2,145000)
INSERT INTO CHITIETPHIEUXUAT VALUES ('PX022','DH022','MH003',1,110000)
INSERT INTO CHITIETPHIEUXUAT VALUES ('PX023','DH023','MH004',2,50000)
INSERT INTO CHITIETPHIEUXUAT VALUES ('PX023','DH023','MH005',3,260000)
INSERT INTO CHITIETPHIEUXUAT VALUES ('PX024','DH024','MH006',4,250000)
INSERT INTO CHITIETPHIEUXUAT VALUES ('PX025','DH025','MH007',5,160000)
INSERT INTO CHITIETPHIEUXUAT VALUES ('PX025','DH025','MH008',4,330000)
INSERT INTO CHITIETPHIEUXUAT VALUES ('PX026','DH026','MH009',7,70000)
INSERT INTO CHITIETPHIEUXUAT VALUES ('PX026','DH026','MH010',8,160000)
INSERT INTO CHITIETPHIEUXUAT VALUES ('PX026','DH026','MH011',6,30000)
INSERT INTO CHITIETPHIEUXUAT VALUES ('PX027','DH027','MH012',5,25000)
INSERT INTO CHITIETPHIEUXUAT VALUES ('PX028','DH028','MH013',4,110000)
INSERT INTO CHITIETPHIEUXUAT VALUES ('PX029','DH029','MH014',3,45000)
INSERT INTO CHITIETPHIEUXUAT VALUES ('PX029','DH029','MH015',4,50000)
INSERT INTO CHITIETPHIEUXUAT VALUES ('PX030','DH030','MH030',5,620000)
INSERT INTO CHITIETPHIEUXUAT VALUES ('PX031','DH031','MH031',6,690000)
INSERT INTO CHITIETPHIEUXUAT VALUES ('PX031','DH031','MH032',9,700000)
INSERT INTO CHITIETPHIEUXUAT VALUES ('PX032','DH032','MH033',8,90000)
INSERT INTO CHITIETPHIEUXUAT VALUES ('PX032','DH032','MH034',6,65000)
INSERT INTO CHITIETPHIEUXUAT VALUES ('PX033','DH033','MH035',5,50000)
INSERT INTO CHITIETPHIEUXUAT VALUES ('PX033','DH033','MH036',2,170000)
INSERT INTO CHITIETPHIEUXUAT VALUES ('PX033','DH033','MH037',3,90000)
INSERT INTO CHITIETPHIEUXUAT VALUES ('PX034','DH034','MH038',3,45000)
INSERT INTO CHITIETPHIEUXUAT VALUES ('PX035','DH035','MH039',4,85000)

SELECT*FROM CHITIETPHIEUXUAT

--INSERT THONG TIN VAO BANG PHIEUGIAOHANG
INSERT INTO PHIEUGIAOHANG VALUES ('PG001','DH001','NV006','13/01/2022',19660)
INSERT INTO PHIEUGIAOHANG VALUES ('PG002','DH002','NV006','13/01/2022',40535)
INSERT INTO PHIEUGIAOHANG VALUES ('PG003','DH003','NV006','13/01/2022',27792)
INSERT INTO PHIEUGIAOHANG VALUES ('PG004','DH004','NV006','13/01/2022',17982)
INSERT INTO PHIEUGIAOHANG VALUES ('PG005','DH005','NV006','09/02/2022',35646)
INSERT INTO PHIEUGIAOHANG VALUES ('PG006','DH006','NV006','09/02/2022',42505)
INSERT INTO PHIEUGIAOHANG VALUES ('PG007','DH007','NV006','09/02/2022',15184)
INSERT INTO PHIEUGIAOHANG VALUES ('PG008','DH008','NV006','14/02/2022',39059)
INSERT INTO PHIEUGIAOHANG VALUES ('PG009','DH009','NV006','16/02/2022',19547)
INSERT INTO PHIEUGIAOHANG VALUES ('PG010','DH010','NV006','18/02/2022',34138)
INSERT INTO PHIEUGIAOHANG VALUES ('PG011','DH011','NV006','18/02/2022',34707)
INSERT INTO PHIEUGIAOHANG VALUES ('PG012','DH012','NV006','15/03/2022',22716)
INSERT INTO PHIEUGIAOHANG VALUES ('PG013','DH013','NV006','15/03/2022',40561)
INSERT INTO PHIEUGIAOHANG VALUES ('PG014','DH014','NV006','15/03/2022',30167)
INSERT INTO PHIEUGIAOHANG VALUES ('PG015','DH015','NV006','15/03/2022',27516)
INSERT INTO PHIEUGIAOHANG VALUES ('PG016','DH016','NV006','15/03/2022',33629)
INSERT INTO PHIEUGIAOHANG VALUES ('PG017','DH017','NV006','19/03/2022',36101)
INSERT INTO PHIEUGIAOHANG VALUES ('PG018','DH018','NV006','21/03/2022',45696)
INSERT INTO PHIEUGIAOHANG VALUES ('PG019','DH019','NV006','19/05/2022',32182)
INSERT INTO PHIEUGIAOHANG VALUES ('PG020','DH020','NV006','09/06/2022',44865)
INSERT INTO PHIEUGIAOHANG VALUES ('PG021','DH021','NV006','01/07/2022',16877)
INSERT INTO PHIEUGIAOHANG VALUES ('PG022','DH022','NV006','16/7/2022',23421)
INSERT INTO PHIEUGIAOHANG VALUES ('PG023','DH023','NV006','10/08/2022',44514)
INSERT INTO PHIEUGIAOHANG VALUES ('PG024','DH024','NV006','12/08/2022',23861)
INSERT INTO PHIEUGIAOHANG VALUES ('PG025','DH025','NV006','12/09/2022',47407)
INSERT INTO PHIEUGIAOHANG VALUES ('PG026','DH026','NV006','03/11/2022',40348)
INSERT INTO PHIEUGIAOHANG VALUES ('PG027','DH027','NV006','15/11/2022',22189)
INSERT INTO PHIEUGIAOHANG VALUES ('PG028','DH028','NV006','15/11/2022',48225)
INSERT INTO PHIEUGIAOHANG VALUES ('PG029','DH029','NV006','16/11/2022',42580)
INSERT INTO PHIEUGIAOHANG VALUES ('PG030','DH030','NV006','25/12/2022',42338)
INSERT INTO PHIEUGIAOHANG VALUES ('PG031','DH031','NV006','26/12/2022',45365)
INSERT INTO PHIEUGIAOHANG VALUES ('PG032','DH032','NV006','26/12/2022',46670)
INSERT INTO PHIEUGIAOHANG VALUES ('PG033','DH033','NV006',NULL,24030)
INSERT INTO PHIEUGIAOHANG VALUES ('PG034','DH034','NV006',NULL,27923)
INSERT INTO PHIEUGIAOHANG VALUES ('PG035','DH035','NV006',NULL,38424)

SELECT*FROM PHIEUGIAOHANG

--INSERT THONG TIN VAO BANG THANHTOAN
INSERT INTO THANHTOAN VALUES ('HD001','DH001','NV002','13/01/2022',1260000,N'Đã Thanh Toán')
INSERT INTO THANHTOAN VALUES ('HD002','DH002','NV002','13/01/2022',1970000,N'Đã Thanh Toán')
INSERT INTO THANHTOAN VALUES ('HD003','DH003','NV002','13/01/2022',15810000,N'Đã Thanh Toán')
INSERT INTO THANHTOAN VALUES ('HD004','DH004','NV002','13/01/2022',3250000,N'Đã Thanh Toán')
INSERT INTO THANHTOAN VALUES ('HD005','DH005','NV002','09/02/2022',8280000,N'Đã Thanh Toán')
INSERT INTO THANHTOAN VALUES ('HD006','DH006','NV002','09/02/2022',980000,N'Đã Thanh Toán')
INSERT INTO THANHTOAN VALUES ('HD007','DH007','NV002','09/02/2022',1815000,N'Đã Thanh Toán')
INSERT INTO THANHTOAN VALUES ('HD008','DH008','NV002','14/02/2022',660000,N'Đã Thanh Toán')
INSERT INTO THANHTOAN VALUES ('HD009','DH009','NV002','16/02/2022',485000,N'Đã Thanh Toán')
INSERT INTO THANHTOAN VALUES ('HD010','DH010','NV002','18/02/2022',435000,N'Đã Thanh Toán')
INSERT INTO THANHTOAN VALUES ('HD011','DH011','NV003','18/02/2022',300000,N'Đã Thanh Toán')
INSERT INTO THANHTOAN VALUES ('HD012','DH012','NV003','15/03/2022',5600000,N'Đã Thanh Toán')
INSERT INTO THANHTOAN VALUES ('HD013','DH013','NV003','15/03/2022',12220000,N'Đã Thanh Toán')
INSERT INTO THANHTOAN VALUES ('HD014','DH014','NV003','15/03/2022',8390000,N'Đã Thanh Toán')
INSERT INTO THANHTOAN VALUES ('HD015','DH015','NV003','15/03/2022',663000,N'Đã Thanh Toán')
INSERT INTO THANHTOAN VALUES ('HD016','DH016','NV003','15/03/2022',4220000,N'Đã Thanh Toán')
INSERT INTO THANHTOAN VALUES ('HD017','DH017','NV003','19/03/2022',14210000,N'Đã Thanh Toán')
INSERT INTO THANHTOAN VALUES ('HD018','DH018','NV003','21/03/2022',540000,N'Đã Thanh Toán')
INSERT INTO THANHTOAN VALUES ('HD019','DH019','NV002','19/05/2022',1015000,N'Đã Thanh Toán')
INSERT INTO THANHTOAN VALUES ('HD020','DH020','NV002','09/06/2022',510000,N'Đã Thanh Toán')
INSERT INTO THANHTOAN VALUES ('HD021','DH021','NV002','30/06/2022',830000,N'Đã Thanh Toán')
INSERT INTO THANHTOAN VALUES ('HD022','DH022','NV002','16/07/2022',400000,N'Đã Thanh Toán')
INSERT INTO THANHTOAN VALUES ('HD023','DH023','NV002','10/08/2022',880000,N'Đã Thanh Toán')
INSERT INTO THANHTOAN VALUES ('HD024','DH024','NV002','12/08/2022',1000000,N'Đã Thanh Toán')
INSERT INTO THANHTOAN VALUES ('HD025','DH025','NV002','12/09/2022',2120000,N'Đã Thanh Toán')
INSERT INTO THANHTOAN VALUES ('HD026','DH026','NV003','3/11/2022',1950000,N'Đã Thanh Toán')
INSERT INTO THANHTOAN VALUES ('HD027','DH027','NV003','15/11/2022',125000,N'Đã Thanh Toán')
INSERT INTO THANHTOAN VALUES ('HD028','DH028','NV003','15/11/2022',440000,N'Đã Thanh Toán')
INSERT INTO THANHTOAN VALUES ('HD029','DH029','NV003','16/11/2022',335000,N'Đã Thanh Toán')
INSERT INTO THANHTOAN VALUES ('HD030','DH030','NV003','25/12/2022',3100000,N'Đã Thanh Toán')
INSERT INTO THANHTOAN VALUES ('HD031','DH031','NV003','26/12/2022',10315800,N'Đã Thanh Toán')
INSERT INTO THANHTOAN VALUES ('HD032','DH032','NV003','26/12/2022',1110000,N'Đã Thanh Toán')
INSERT INTO THANHTOAN VALUES ('HD033','DH033','NV002',NULL,851900,N'Chưa Thanh Toán')
INSERT INTO THANHTOAN VALUES ('HD034','DH034','NV002','24/12/2022',135000,N'Đã Thanh Toán')
INSERT INTO THANHTOAN VALUES ('HD035','DH035','NV002',NULL,340000,N'Chưa Thanh Toán')

SELECT*FROM THANHTOAN

--INSERT THONG TIN VAO BANG PHANQUYEN
INSERT INTO PHANQUYEN VALUES ('Q01',N'Xem danh sách mặt hàng',N'Nhân viên, quản lý, khách hàng')
INSERT INTO PHANQUYEN VALUES ('Q02',N'Xem thông tin mặt hàng',N'Nhân viên, quản lý, khách hàng')
INSERT INTO PHANQUYEN VALUES ('Q03',N'Đăng ký',N'Nhân viên, quản lý, khách hàng')
INSERT INTO PHANQUYEN VALUES ('Q04',N'Đăng nhập',N'Nhân viên, quản lý, khách hàng')
INSERT INTO PHANQUYEN VALUES ('Q05',N'Đặt mua',N'Nhân viên, quản lý, khách hàng')
INSERT INTO PHANQUYEN VALUES ('Q06',N'Thanh toán',N'Nhân viên, quản lý, khách hàng')
INSERT INTO PHANQUYEN VALUES ('Q07',N'Xem danh sách đơn hàng',N'Nhân viên, quản lý, khách hàng')
INSERT INTO PHANQUYEN VALUES ('Q08',N'Quản lý đơn hàng',N'Nhân viên, quản lý, khách hàng')
INSERT INTO PHANQUYEN VALUES ('Q09',N'Quản lý mặt hàng',N'Nhân viên, quản lý')
INSERT INTO PHANQUYEN VALUES ('Q10',N'Quản lý khách hàng',N'Nhân viên, quản lý')
INSERT INTO PHANQUYEN VALUES ('Q11',N'Quản lý một số thông tin khác',N'Nhân viên, quản lý')
INSERT INTO PHANQUYEN VALUES ('Q12',N'Thống kê, báo cáo',N'Nhân viên, quản lý')
INSERT INTO PHANQUYEN VALUES ('Q13',N'Quản lý nhân viên',N'Quản lý')

SELECT*FROM PHANQUYEN

--INSERT THONG TIN VAO BANG TAIKHOAN_QUYEN
INSERT INTO TAIKHOAN_QUYEN VALUES ('NV001','Q01')
INSERT INTO TAIKHOAN_QUYEN VALUES ('NV002','Q01')
INSERT INTO TAIKHOAN_QUYEN VALUES ('NV003','Q01')
INSERT INTO TAIKHOAN_QUYEN VALUES ('NV004','Q01')
INSERT INTO TAIKHOAN_QUYEN VALUES ('NV005','Q01')
INSERT INTO TAIKHOAN_QUYEN VALUES ('NV006','Q01')
INSERT INTO TAIKHOAN_QUYEN VALUES ('NV001','Q02')
INSERT INTO TAIKHOAN_QUYEN VALUES ('NV002','Q02')
INSERT INTO TAIKHOAN_QUYEN VALUES ('NV003','Q02')
INSERT INTO TAIKHOAN_QUYEN VALUES ('NV004','Q02')
INSERT INTO TAIKHOAN_QUYEN VALUES ('NV005','Q02')
INSERT INTO TAIKHOAN_QUYEN VALUES ('NV006','Q02')
INSERT INTO TAIKHOAN_QUYEN VALUES ('NV001','Q03')
INSERT INTO TAIKHOAN_QUYEN VALUES ('NV002','Q03')
INSERT INTO TAIKHOAN_QUYEN VALUES ('NV003','Q03')
INSERT INTO TAIKHOAN_QUYEN VALUES ('NV004','Q03')
INSERT INTO TAIKHOAN_QUYEN VALUES ('NV005','Q03')
INSERT INTO TAIKHOAN_QUYEN VALUES ('NV006','Q03')
INSERT INTO TAIKHOAN_QUYEN VALUES ('NV001','Q04')
INSERT INTO TAIKHOAN_QUYEN VALUES ('NV002','Q04')
INSERT INTO TAIKHOAN_QUYEN VALUES ('NV003','Q04')
INSERT INTO TAIKHOAN_QUYEN VALUES ('NV004','Q04')
INSERT INTO TAIKHOAN_QUYEN VALUES ('NV005','Q04')
INSERT INTO TAIKHOAN_QUYEN VALUES ('NV006','Q04')
INSERT INTO TAIKHOAN_QUYEN VALUES ('NV001','Q05')
INSERT INTO TAIKHOAN_QUYEN VALUES ('NV002','Q05')
INSERT INTO TAIKHOAN_QUYEN VALUES ('NV003','Q05')
INSERT INTO TAIKHOAN_QUYEN VALUES ('NV004','Q05')
INSERT INTO TAIKHOAN_QUYEN VALUES ('NV005','Q05')
INSERT INTO TAIKHOAN_QUYEN VALUES ('NV006','Q05')
INSERT INTO TAIKHOAN_QUYEN VALUES ('NV001','Q06')
INSERT INTO TAIKHOAN_QUYEN VALUES ('NV002','Q06')
INSERT INTO TAIKHOAN_QUYEN VALUES ('NV003','Q06')
INSERT INTO TAIKHOAN_QUYEN VALUES ('NV004','Q06')
INSERT INTO TAIKHOAN_QUYEN VALUES ('NV005','Q06')
INSERT INTO TAIKHOAN_QUYEN VALUES ('NV006','Q06')
INSERT INTO TAIKHOAN_QUYEN VALUES ('NV001','Q07')
INSERT INTO TAIKHOAN_QUYEN VALUES ('NV002','Q07')
INSERT INTO TAIKHOAN_QUYEN VALUES ('NV003','Q07')
INSERT INTO TAIKHOAN_QUYEN VALUES ('NV004','Q07')
INSERT INTO TAIKHOAN_QUYEN VALUES ('NV005','Q07')
INSERT INTO TAIKHOAN_QUYEN VALUES ('NV006','Q07')
INSERT INTO TAIKHOAN_QUYEN VALUES ('NV001','Q08')
INSERT INTO TAIKHOAN_QUYEN VALUES ('NV002','Q08')
INSERT INTO TAIKHOAN_QUYEN VALUES ('NV003','Q08')
INSERT INTO TAIKHOAN_QUYEN VALUES ('NV004','Q08')
INSERT INTO TAIKHOAN_QUYEN VALUES ('NV005','Q08')
INSERT INTO TAIKHOAN_QUYEN VALUES ('NV006','Q08')
INSERT INTO TAIKHOAN_QUYEN VALUES ('NV001','Q09')
INSERT INTO TAIKHOAN_QUYEN VALUES ('NV002','Q09')
INSERT INTO TAIKHOAN_QUYEN VALUES ('NV003','Q09')
INSERT INTO TAIKHOAN_QUYEN VALUES ('NV004','Q09')
INSERT INTO TAIKHOAN_QUYEN VALUES ('NV005','Q09')
INSERT INTO TAIKHOAN_QUYEN VALUES ('NV006','Q09')
INSERT INTO TAIKHOAN_QUYEN VALUES ('NV001','Q10')
INSERT INTO TAIKHOAN_QUYEN VALUES ('NV002','Q10')
INSERT INTO TAIKHOAN_QUYEN VALUES ('NV003','Q10')
INSERT INTO TAIKHOAN_QUYEN VALUES ('NV004','Q10')
INSERT INTO TAIKHOAN_QUYEN VALUES ('NV005','Q10')
INSERT INTO TAIKHOAN_QUYEN VALUES ('NV006','Q10')
INSERT INTO TAIKHOAN_QUYEN VALUES ('NV001','Q11')
INSERT INTO TAIKHOAN_QUYEN VALUES ('NV002','Q11')
INSERT INTO TAIKHOAN_QUYEN VALUES ('NV003','Q11')
INSERT INTO TAIKHOAN_QUYEN VALUES ('NV004','Q11')
INSERT INTO TAIKHOAN_QUYEN VALUES ('NV005','Q11')
INSERT INTO TAIKHOAN_QUYEN VALUES ('NV006','Q11')
INSERT INTO TAIKHOAN_QUYEN VALUES ('NV001','Q12')
INSERT INTO TAIKHOAN_QUYEN VALUES ('NV002','Q12')
INSERT INTO TAIKHOAN_QUYEN VALUES ('NV003','Q12')
INSERT INTO TAIKHOAN_QUYEN VALUES ('NV004','Q12')
INSERT INTO TAIKHOAN_QUYEN VALUES ('NV005','Q12')
INSERT INTO TAIKHOAN_QUYEN VALUES ('NV006','Q12')
INSERT INTO TAIKHOAN_QUYEN VALUES ('NV001','Q13')

SELECT*FROM TAIKHOAN_QUYEN

--INSERT THONG TIN VAO BANG KHACHHANG_QUYEN
INSERT INTO KHACHHANG_QUYEN VALUES ('KH001','Q01')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH002','Q01')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH003','Q01')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH004','Q01')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH005','Q01')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH006','Q01')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH007','Q01')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH008','Q01')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH009','Q01')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH010','Q01')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH011','Q01')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH012','Q01')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH013','Q01')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH014','Q01')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH015','Q01')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH016','Q01')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH017','Q01')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH018','Q01')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH019','Q01')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH020','Q01')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH021','Q01')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH022','Q01')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH023','Q01')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH024','Q01')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH025','Q01')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH026','Q01')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH027','Q01')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH028','Q01')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH029','Q01')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH030','Q01')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH001','Q02')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH002','Q02')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH003','Q02')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH004','Q02')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH005','Q02')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH006','Q02')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH007','Q02')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH008','Q02')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH009','Q02')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH010','Q02')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH011','Q02')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH012','Q02')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH013','Q02')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH014','Q02')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH015','Q02')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH016','Q02')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH017','Q02')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH018','Q02')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH019','Q02')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH020','Q02')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH021','Q02')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH022','Q02')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH023','Q02')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH024','Q02')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH025','Q02')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH026','Q02')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH027','Q02')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH028','Q02')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH029','Q02')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH030','Q02')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH001','Q03')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH002','Q03')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH003','Q03')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH004','Q03')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH005','Q03')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH006','Q03')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH007','Q03')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH008','Q03')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH009','Q03')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH010','Q03')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH011','Q03')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH012','Q03')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH013','Q03')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH014','Q03')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH015','Q03')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH016','Q03')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH017','Q03')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH018','Q03')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH019','Q03')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH020','Q03')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH021','Q03')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH022','Q03')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH023','Q03')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH024','Q03')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH025','Q03')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH026','Q03')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH027','Q03')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH028','Q03')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH029','Q03')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH030','Q03')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH001','Q04')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH002','Q04')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH003','Q04')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH004','Q04')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH005','Q04')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH006','Q04')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH007','Q04')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH008','Q04')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH009','Q04')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH010','Q04')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH011','Q04')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH012','Q04')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH013','Q04')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH014','Q04')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH015','Q04')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH016','Q04')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH017','Q04')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH018','Q04')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH019','Q04')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH020','Q04')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH021','Q04')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH022','Q04')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH023','Q04')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH024','Q04')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH025','Q04')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH026','Q04')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH027','Q04')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH028','Q04')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH029','Q04')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH030','Q04')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH001','Q05')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH002','Q05')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH003','Q05')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH004','Q05')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH005','Q05')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH006','Q05')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH007','Q05')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH008','Q05')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH009','Q05')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH010','Q05')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH011','Q05')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH012','Q05')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH013','Q05')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH014','Q05')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH015','Q05')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH016','Q05')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH017','Q05')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH018','Q05')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH019','Q05')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH020','Q05')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH021','Q05')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH022','Q05')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH023','Q05')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH024','Q05')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH025','Q05')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH026','Q05')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH027','Q05')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH028','Q05')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH029','Q05')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH030','Q05')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH001','Q06')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH002','Q06')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH003','Q06')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH004','Q06')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH005','Q06')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH006','Q06')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH007','Q06')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH008','Q06')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH009','Q06')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH010','Q06')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH011','Q06')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH012','Q06')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH013','Q06')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH014','Q06')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH015','Q06')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH016','Q06')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH017','Q06')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH018','Q06')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH019','Q06')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH020','Q06')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH021','Q06')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH022','Q06')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH023','Q06')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH024','Q06')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH025','Q06')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH026','Q06')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH027','Q06')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH028','Q06')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH029','Q06')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH030','Q06')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH001','Q07')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH002','Q07')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH003','Q07')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH004','Q07')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH005','Q07')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH006','Q07')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH007','Q07')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH008','Q07')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH009','Q07')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH010','Q07')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH011','Q07')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH012','Q07')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH013','Q07')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH014','Q07')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH015','Q07')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH016','Q07')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH017','Q07')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH018','Q07')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH019','Q07')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH020','Q07')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH021','Q07')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH022','Q07')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH023','Q07')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH024','Q07')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH025','Q07')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH026','Q07')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH027','Q07')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH028','Q07')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH029','Q07')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH030','Q07')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH001','Q08')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH002','Q08')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH003','Q08')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH004','Q08')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH005','Q08')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH006','Q08')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH007','Q08')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH008','Q08')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH009','Q08')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH010','Q08')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH011','Q08')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH012','Q08')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH013','Q08')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH014','Q08')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH015','Q08')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH016','Q08')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH017','Q08')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH018','Q08')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH019','Q08')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH020','Q08')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH021','Q08')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH022','Q08')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH023','Q08')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH024','Q08')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH025','Q08')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH026','Q08')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH027','Q08')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH028','Q08')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH029','Q08')
INSERT INTO KHACHHANG_QUYEN VALUES ('KH030','Q08')

SELECT*FROM KHACHHANG_QUYEN

--Bai7
--b) Update dữ liệu vào các table bằng lệnh SQL
--UPDATE DU LIEU VAO CAC TABLE
UPDATE PHIEUGIAOHANG SET NgayGiao = '3/1/2023' WHERE MaPG = 'PG033'
UPDATE PHIEUGIAOHANG SET NgayGiao = '5/1/2023' WHERE MaPG = 'PG034'
UPDATE PHIEUGIAOHANG SET NgayGiao = '20/2/2023' WHERE MaPG ='PG035'


UPDATE THANHTOAN SET NgayTT = '31/12/2022', TrangThai = N'Đã Thanh Toán' where MaHDTT = 'HD033'
UPDATE THANHTOAN SET NgayTT = '17/02/2023', TrangThai = N'Đã Thanh Toán' where MaHDTT = 'HD035'

--7c)

INSERT INTO KHACHHANG VALUES ('KH031',N'Nguyễn Nam Sơn',N'Nam','0386515607',N'12 KDT Anh Dũng 9, Dương Kinh, Đồng Nai','namson','5710897')
INSERT INTO KHACHHANG VALUES ('KH032',N'Nguyễn Lệ Mai',N'Nữ','0386515628',N'28 Phạm Ngũ Lão, Q9, TP.HCM','lemai','5718888')
INSERT INTO LOAIHANG VALUES ('LH011',N'Chanh')
INSERT INTO NHACUNGCAP VALUES ('NCC05',N'Công Ty nhập khẩu trái cây Fruito','0749362333',N'198 An Dương Vương, P. An Phú Đông, Q.11, TP.HCM')
INSERT INTO NHACUNGCAP VALUES ('NCC06',N'Công Ty trái cây nhiệt đới','0979362303',N'Xã Hòa Lộc, Huyện Vân Sơn, Lào Cai')

DELETE FROM KHACHHANG WHERE MaKH = 'KH031'
DELETE FROM KHACHHANG WHERE HoTen = N'Nguyễn Lệ Mai'
DELETE FROM LOAIHANG WHERE MaLoai = 'LH011'
DELETE FROM NHACUNGCAP WHERE MaNCC = 'NCC05'
DELETE FROM NHACUNGCAP WHERE DiaChi LIKE '%Lào Cai'

--8a)
--CHO BIET HOTEN, DIACHI, SDT CUA NHAN VIEN NU
SELECT HoTen, DiaChi, Sdt FROM NHANVIEN
WHERE GioiTinh = N'Nữ'
--CHO BIET HOTEN KHACH HANG, SDT CUA NHUNG KHACH HANG CÓ DIA CHI O TPHCM
SELECT HoTen, Sdt, DiaChi FROM KHACHHANG 
WHERE DiaChi LIKE N'%TP.HCM%'

--CHO BIET CAC MAT HANG CÓ GIA TREN 500000
SELECT * FROM MATHANG
WHERE GiaBan > 500000

--CHO BIET MA NHAN VIEN, TENNV, SDT CUA NHANVIEN CO CHUC VU LA BAN HANG
SELECT MaNV, HoTen, Sdt
FROM NHANVIEN WHERE ChucVu = N'Bán Hàng'

--8b)
--LIET KE HO TEN NHAN VIEN VA SO HOA DON THANH TOAN DO NHAN VIEN DO DAM NHAN
SELECT NHANVIEN.HoTen, MaHDTT
FROM NHANVIEN INNER JOIN THANHTOAN ON NHANVIEN.MaNV = THANHTOAN.MaNV

--CHO BIET TEN KHACH HANG, TEN MAT HANG, SO LUONG MA KHACH ĐÓ MUA VỚI SL > 5
SELECT KHACHHANG.HoTen, CHITIETDONHANG.MaHang, CHITIETDONHANG.SoLuong
FROM KHACHHANG  JOIN DONHANG ON KHACHHANG.MaKH = DONHANG.MaKH
			 JOIN CHITIETDONHANG ON DONHANG.MaDH = CHITIETDONHANG.MaDH
WHERE CHITIETDONHANG.SoLuong > 5

--CHO BIET NHUNG DON HANG CHUA THANH TOAN LA CUA KHACH HANG NÀO
SELECT KHACHHANG.HoTen, DONHANG.MaDH, DONHANG.TinhTrangTT
FROM KHACHHANG INNER JOIN DONHANG ON KHACHHANG.MaKH = DONHANG.MaKH
WHERE TinhTrangTT = N'Chưa TT'

--LIET KE MA PX, NGÀY XUẤT, MÃ KH CỦA CÁC PHIẾU XUẤT PHÁT SINH TRONG QUÝ 2/2022
SELECT DISTINCT PHIEUXUAT.MaPX, PHIEUXUAT.NgayXuat, DONHANG.MaKH
FROM PHIEUXUAT JOIN CHITIETPHIEUXUAT ON PHIEUXUAT.MaPX = CHITIETPHIEUXUAT.MaPX
	JOIN DONHANG ON DONHANG.MaDH = CHITIETPHIEUXUAT.MaDH
WHERE MONTH(NgayXuat) in ('4','5','6')

--8c)
--TRUY VAN CO DIEU KIEN
---AND
----Hiển thị danh sách tất cả các nhân viên có thông tin hiển thị Mã NV, Họ Tên, Giới Tính, Địa Chỉ mà Giới Tính là Nữ và tên có chữ Lan
SELECT MaNV, HoTen, GioiTinh,ChucVu,DiaChi
FROM NHANVIEN
WHERE GioiTinh = 'Nam' AND ChucVu = N'Giao hàng'

---OR
----Hiển thị danh sách các mặt hàng gồm Mã hàng, Tên hàng, Xuất xứ, Giá bán có xuất xứ ở Hàn Quốc hoặc Việt Nam
SELECT MaHang,TenHang, XuatXu,GiaBan
FROM MATHANG
WHERE XuatXu = N'Việt Nam' OR XuatXu = N'Hàn Quốc'
ORDER BY XuatXu

---LIKE
----Hiển thị danh sách khách hàng gồm Mã KH, Họ Tên, Địa Chỉ của những khách hàng sống ở TPHCM
SELECT MaKH, HoTen, DiaChi
FROM KHACHHANG
WHERE DiaChi LIKE '%TP.HCM%'

---BETWEEN
----Hiển thị danh sách các đơn hàng bao gồm thông tin về Mã Đơn Hàng, Mã KH, Ngày Đặt có Ngày Đặt trong khoảng từ 1/1/2022 - 16/3/2022
SELECT MaDH, MaKH, NgayDat
FROM DONHANG
WHERE NgayDat BETWEEN '1/1/2022' AND '16/03/2022'

--8d)
---Tính thành tiền của các đơn đặt hàng khi chưa áp dụng khuyến mãi. 
---Thông tin hiển thị Mã Đơn Hàng, Tổng tiền.
select MaDH, sum(GiaTien) as 'Tong tien'
from CHITIETDONHANG
group by MaDH

---Hiển thị danh sách các mặt hàng thuộc chi tiết đơn hàng được áp dụng chương trình giảm giá. 
---Tính số tiền sau khi giảm và số tiền đã được giảm tương ứng với từng mặt hàng.
---Thông tin hiển thị bao gồm Mã Hàng, Mã Đơn Hàng, Tên Hàng, Giá Bán, Số Lượng, Mức Giảm, Số tiền sau khi giảm, Số tiền được giảm.
select ctdh.MaHang, ctdh.MaDH, mh.TenHang, ctdh.GiaBan, ctdh.SoLuong, gg.MucGiam, 
	(1-gg.MucGiam)*ctdh.GiaBan*ctdh.SoLuong as 'So tien sau khi giam', 
	ctdh.GiaBan*ctdh.SoLuong - (1-gg.MucGiam)*ctdh.GiaBan*ctdh.SoLuong as 'So tien duoc giam'
from GIAMGIA gg, CHITIETDONHANG ctdh, DONHANG dh, MATHANG mh
where gg.MaGiamGia = ctdh.MaGiamGia and ctdh.MaDH = dh.MaDH 
		and mh.MaHang = ctdh.MaHang and dh.NgayDat between gg.NgayBatDau and gg.NgayKetThuc

---Tính tiền lời trên một sản phẩm bán ra khi chưa áp dụng khuyến mãi. Tiền lời của một sản phẩm tính bằng (giá bán - giá mua). 
---Thông tin hiển thị bao gồm Mã Đơn Hàng, Mã Hàng, Tên Hàng, Số Lượng, Giá Bán, Đơn Giá, Tiền lời
select ctdh.MaDH,ctdh.MaHang,mh.TenHang, ctdh.SoLuong,
	ctdh.GiaBan, ctpn.DonGia, (ctdh.GiaBan - ctpn.DonGia) as 'Tienloi'
from CHITIETDONHANG ctdh, MATHANG mh, CHITIETPHIEUNHAP ctpn
where ctdh.MaHang = mh.MaHang and ctpn.MaHang = mh.MaHang
---Thống kê số lượng mặt hàng đã bán được theo mã hàng, sắp xếp số lượng mặt hàng bán được theo thứ tự giảm dần.
---Thông tin hiển thị bao gồm Mã Hàng, Tên Hàng, Số Lượng Thống Kê Theo Từng Mặt Hàng.
select ctdh.MaHang,mh.TenHang, sum(SoLuong) as 'SoLuongThongKeTheoTungMatHang'
from CHITIETDONHANG ctdh, MATHANG mh
where ctdh.MaHang = mh.MaHang
group by ctdh.MaHang, mh.TenHang
order by SoLuongThongKeTheoTungMatHang desc

--8e)
/*Câu 1*/
---Tính số lượng khách hàng Nam, Nữ của cửa hàng.Thông tin hiển thị bao gồm Giới Tính, Số lượng nhân viên theo giới.
select GioiTinh,count(MaKH) as soluong
from KHACHHANG
group by GioiTinh
/*Câu 2*/
---Tính số lượng đơn hàng trong trạng thái Đã Thanh Toán, Chưa Thanh Toán. Thông tin hiển thị bao gồm Trạng Thái Thanh Toán, Số lượng đơn hàng ứng với mỗi trạng thái.
select TrangThai, count(MaHDTT) as Soluong
from THANHTOAN
group by TrangThai

/*Câu 3*/
---Tính số mặt hàng thuộc từng loại hàng của cửa hàng. Thông tin hiển thị bao gồm Mã Loại, Tên Loại, Số Lượng mặt hàng ứng với từng loại.
select lh.MaLoai,lh.TenLoai, count(lh.MaLoai) as SoLuong
from LOAIHANG lh, MATHANG mh
where lh.MaLoai = mh.MaLoai
group by lh.MaLoai, lh.TenLoai
/*Câu 4*/
---Tính số lượng đơn hàng ở trong trạng thái đã giao, đang giao. Thông tin hiển thị bao gồm Tình Trạng Giao, Số lượng đơn hàng ứng với mỗi tình trạng giao.
select TinhTrangGiao, count(MaDH) as soluong
from DONHANG
group by TinhTrangGiao

--8f)
---Liệt kê các mặt hàng có số lượng bán > 10. Thông tin hiển thị bao gồm Mã Hàng, Tên Hàng, số lượng bán. Và sắp xếp số lượng mặt hàng bán được theo thứ tự tăng dần.
select ctdh.MaHang, mh.TenHang, Sum(SoLuong) as soluongban
from CHITIETDONHANG ctdh, MATHANG mh
where ctdh. MaHang = mh.MaHang
group by ctdh.MaHang, MH.TenHang
having Sum(SoLuong) > 10
order by soluongban asc

---Liệt kê các mặt hàng có số lượng nhập < 6. Thông tin hiển thị Mã Hàng, Tên Hàng, Số Lượng Nhập.
select ctpn.MaHang, mh.TenHang, sum(SoLuong) as soluongnhap
from CHITIETPHIEUNHAP ctpn, MATHANG mh
where ctpn.MaHang = mh.MaHang
group by ctpn.MaHang, mh.TenHang
having sum(SoLuong) < 6

--- Liệt kê các ngày mà nhân viên giao hàng phải giao nhiều hơn ba đơn hàng. Thông tin hiển thị bao gồm Ngày, Số lượng đơn giao, Nhân viên giao hàng.
select cast(day(NgayGiao) as nvarchar(2)) + ' -' + cast(month(NgayGiao) as nvarchar(2)) 
		+ ' - ' + cast(year(NgayGiao) as nvarchar(4)) as Ngay ,
		count(NgayGiao) as soluongdongiao, nv.HoTen as nhanviengiaohang
from PHIEUGIAOHANG pgh, NHANVIEN nv
where NgayGiao IS NOT NULL
and pgh.MaNV = nv.MaNV
group by NgayGiao, nv.HoTen
having count(NgayGiao) > 3

---Liệt kê số tháng có >1 lần nhập hàng. Thông tin hiển thị bao gồm Tháng, số lượng đơn nhập ứng với tháng.
select month(NgayNhap) as Thang, count(month(NgayNhap)) as soluongdonnhap
from PHIEUNHAP pn
group by month(NgayNhap)
having count(month(NgayNhap)) > 1

--8g)
-- Phép hội
---Liệt kê tất cả các nhà cung cấp có địa chỉ trụ sở tại TP.HCM và Hà Nội. Thông tin hiển thị bao gồm Mã nhà cung cấp, Tên nhà cung cấp, Địa chỉ nhà cung cấp.
select MaNCC, TenNCC, DiaChi
from NHACUNGCAP
where MaNCC IN (
select MaNCC
from NHACUNGCAP
WHERE DiaChi like '%TP.HCM%'
union
select MaNCC
from NHACUNGCAP
WHERE DiaChi like N'%Hà Nội%')

-- Phép giao
---Liệt kê tất cả các đơn hàng vừa đặt Táo Rockit New Zealand, vừa đặt Táo mật Đài Loan. Thông tin hiển thị gồm Mã Đơn Hàng, họ tên khách hàng, sdt khách hàng
select dh.MaDH, kh.HoTen, kh.Sdt
from DONHANG dh, KHACHHANG kh
where dh.MaKH = kh.MaKH
and MaDH IN (Select ctdh.MaDH from CHITIETDONHANG ctdh, MATHANG mh where ctdh.MaHang = mh.MaHang and mh.MaHang = 'MH002' INTERSECT
Select ctdh.MaDH from CHITIETDONHANG ctdh, MATHANG mh where ctdh.MaHang = mh.MaHang and mh.MaHang = 'MH003')

---Liệt kê tất cả các quyền vừa của nhân viên, vừa của quản lý
select MaQuyen,TenQuyen, LoaiQuyen
from PHANQUYEN
where MaQuyen in (select MaQuyen from NHANVIEN nv, TAIKHOAN_QUYEN tkq where nv.MaNV = tkq.MaNV and nv.MaNV = 'NV001'
INTERSECT select MaQuyen from NHANVIEN nv, TAIKHOAN_QUYEN tkq where nv.MaNV = tkq.MaNV and nv.MaNV = 'NV002'
INTERSECT select MaQuyen from NHANVIEN nv, TAIKHOAN_QUYEN tkq where nv.MaNV = tkq.MaNV and nv.MaNV = 'NV003'
INTERSECT select MaQuyen from NHANVIEN nv, TAIKHOAN_QUYEN tkq where nv.MaNV = tkq.MaNV and nv.MaNV = 'NV004'
INTERSECT select MaQuyen from NHANVIEN nv, TAIKHOAN_QUYEN tkq where nv.MaNV = tkq.MaNV and nv.MaNV = 'NV005'
INTERSECT select MaQuyen from NHANVIEN nv, TAIKHOAN_QUYEN tkq where nv.MaNV = tkq.MaNV and nv.MaNV = 'NV006')

-- Phép trừ
---Liệt kê quyền của riêng quản lý
select MaQuyen,TenQuyen, LoaiQuyen
from PHANQUYEN
where MaQuyen in (select MaQuyen from TAIKHOAN_QUYEN except select MaQuyen from NHANVIEN nv, 
				TAIKHOAN_QUYEN tkq where nv.MaNV = tkq.MaNV and nv.MaNV = 'NV001'
INTERSECT select MaQuyen from NHANVIEN nv, TAIKHOAN_QUYEN tkq where nv.MaNV = tkq.MaNV and nv.MaNV = 'NV002'
INTERSECT select MaQuyen from NHANVIEN nv, TAIKHOAN_QUYEN tkq where nv.MaNV = tkq.MaNV and nv.MaNV = 'NV003'
INTERSECT select MaQuyen from NHANVIEN nv, TAIKHOAN_QUYEN tkq where nv.MaNV = tkq.MaNV and nv.MaNV = 'NV004'
INTERSECT select MaQuyen from NHANVIEN nv, TAIKHOAN_QUYEN tkq where nv.MaNV = tkq.MaNV and nv.MaNV = 'NV005'
INTERSECT select MaQuyen from NHANVIEN nv, TAIKHOAN_QUYEN tkq where nv.MaNV = tkq.MaNV and nv.MaNV = 'NV006')

--CAU 8H
--CHO BIET KHACH HANG CO GIOI TINH LA NU VA CO DIA CHI GIAO O HANOI
SELECT MaKH, HoTen FROM KHACHHANG WHERE GioiTinh = N'Nữ' 
AND MaKH IN (SELECT MaKH FROM DONHANG WHERE DiaChiGiao LIKE N'%Hà Nội%')

--CHO BIẾT CÁC KHÁCH HÀNG Ở ĐÀ NẴNG MUA HÀNG TRONG THÁNG 2/2022
SELECT * FROM KHACHHANG WHERE DiaChi LIKE N'%Đà Nẵng%' 
AND MaKH IN (SELECT MaKH FROM DONHANG WHERE (MONTH(NgayDat) = 2 ) AND (YEAR(NgayDat) = 2022))

--CHO BIẾT NHỮNG NHÂN VIÊN CÓ QUYỀN Q01
SELECT MaNV FROM TAIKHOAN_QUYEN WHERE MaQuyen = 'Q01'
AND MaNV IN (SELECT MaNV FROM NHANVIEN)

--CHO BIẾT NHỮNG KHÁCH HÀNG ĐẶT MUA VỚI HÌNH THỨC THANH TOÁN LÀ THẺ
SELECT DISTINCT MaKH FROM DONHANG WHERE HinhThucTT = N'Thẻ'
AND EXISTS (SELECT MaKH FROM KHACHHANG )

--CHO BIẾT TÊN KH NAM CÓ ĐƠN HÀNG TRONG TÌNH TRẠNG ĐÃ GIAO
SELECT HoTen FROM KHACHHANG WHERE GioiTinh = N'Nam'
AND MaKH IN (SELECT MaKH FROM DONHANG WHERE TinhTrangGiao = N'Đã Giao')

--CHO BIẾT MÃ HÀNG, TÊN HÀNG, MÃ LOẠI, MÃ KHO CỦA MẶT HÀNG CÓ SL TỒN KHO LỚN NHẤT
SELECT MaHang, TenHang, MaLoai, MaKho
FROM MATHANG WHERE SoLuongTon = (SELECT MAX (SoLuongTon) FROM MATHANG)

--CAU 8i PIVOT
--Lập bảng thống kê số lượng loại mặt hàng 
select XuatXu as 'Xuất xứ',[Táo], [Nho], [Cam], [Bưởi], [Dưa hấu], [Việt quất], [Dâu tây], [Lê], [Cherry], [Xoài]
from (select lh.MaLoai,lh.TenLoai, mh.XuatXu
from LOAIHANG lh, MATHANG mh
where lh.MaLoai = mh.MaLoai) AS BANGNGUON
PIVOT ( COUNT(bangnguon.Maloai) for bangnguon.TenLoai 
in ( [Táo], [Nho], [Cam], [Bưởi], [Dưa hấu], [Việt quất], [Dâu tây], [Lê], [Cherry], [Xoài])) as bangchuyen

---Lập báo cáo số phiếu nhập lập bởi mỗi nhân viên, phân loại theo nhà cung cấp.
select MaNCC,TenNCC,[NV004], [NV005]
from (select MaNV, ncc.TenNCC, pn.MaNCC 
		FROM PHIEUNHAP pn, NHACUNGCAP ncc where ncc.MaNCC = pn.MaNCC) as bangnguon
pivot 
(count(MaNV) for bangnguon.MaNV IN ([NV004], [NV005])) AS bangchuyen

---Lập báo cáo số phiếu xuất lập bởi mỗi nhân viên, phân loại theo ngày xuất
select cast(day(NgayXuat) as nvarchar(2)) + ' - ' + cast(month(NgayXuat) as nvarchar(2)) 
		+ ' - ' + cast(year(NgayXuat) as nvarchar(4)) as 'Ngày xuất hàng', [NV004], [NV005]
from (select MaNV, NgayXuat from PhieuXuat) as bangnguon
pivot
(count(MaNV) for bangnguon.MaNV IN ([NV004], [NV005])) AS bangchuyen

-- THONG KE TỔNG SỐ LƯỢNG CỦA MỖI MẶT HÀNG ĐƯỢC ĐẶT TRONG THÁNG 1, 2, 3, 4
SELECT TenHang, [1], [2], [3], [4]
	FROM (SELECT TenHang, SUM(SoLuong) AS 'SL' , MONTH(NgayDat) AS 'THANG'
	FROM MATHANG, DONHANG, CHITIETDONHANG
	WHERE MATHANG.MaHang = CHITIETDONHANG.MaHang AND DONHANG.MaDH = CHITIETDONHANG.MaDH
		AND MONTH(NgayDat) BETWEEN 1 AND 4
	GROUP BY TenHang, MONTH(NgayDat)) as A
PIVOT 
( SUM( SL) FOR THANG IN ([1], [2], [3], [4]) ) as B

--CAU9
--STORE PROCEDURE
--THỦ TỤC 1: CẬP NHẬT SỐ LƯỢNG TỒN CỦA MẶT HÀNG CÓ MÃ MH004
CREATE PROCEDURE SP_updateslt @MaHang varchar(10)
AS
BEGIN
	UPDATE MATHANG SET SoLuongTon = SoLuongTon + 5 WHERE MaHang = @MaHang
END
--THỰC THI
EXEC SP_updateslt @MaHang = 'MH004'
SELECT * FROM MATHANG WHERE MaHang = 'MH004'

--THỦ TỤC 2: TÍNH TỔNG SỐ LƯỢNG MẶT HÀNG ĐÃ BÁN THEO MÃ MẶT HÀNG, SẮP XẾP THEO THỨ TỰ TĂNG DẦN
CREATE PROC SP_SLHANGDABAN @MaHang varchar(10)
AS
BEGIN
	SELECT MaHang, SUM(SoLuong) AS 'SL' FROM CHITIETPHIEUXUAT
	GROUP BY MaHang ORDER BY SL ASC
end
--THỰC THI
EXEC SP_SLHANGDABAN 'MH002'

--THỦ TỤC 3: 
--DÙNG ĐỂ BỔ SUNG BẢN GHI MỚI VÀO BẢNG THANHTOAN
--KIỂM TRA TÍNH HỢP LỆ CỦA DỮ LIỆU ĐƯỢC BỔ SUNG
--NGUYÊN TẮC LÀ KHÔNG ĐƯỢC TRÙNG KHÓA CHÍNH VÀ ĐẢM BẢO TOÀN VẸN DỮ LIỆU
create procedure insertthanhtoancheckma(@MaHDTT varchar(10), @MaDH varchar(10),
@MaNV char(5), @NgayTT date, @SoTien decimal(12,2), @TrangThai nvarchar(20))
as
begin
if(not exists(select @MaNV from NHANVIEN where MaNV = @MaNV))
	begin 
		print N'Mã NV' + TRIM(@MaNV) + N' Không tồn tại trong bản NHAN VIEN'
	end
else
	begin
	if(not exists(select MaDH from DONHANG where MaDH = @MaDH))
		begin 
			print N'Mã DH' + TRIM(@MaDH) + N' Không tồn tại trong bản DON HANG'
		end
	else
		begin
			if (not exists(select MaHDTT from THANHTOAN where MaHDTT = @MaHDTT))
				begin 
					insert into THANHTOAN values (@MaHDTT, @MaDH, @MaNV, @NgayTT, @SoTien, @TrangThai)
				end
			else
				begin 
					print N'Mã HDTT ' + TRIM(@MaHDTT) + N' đã có trong bảng THANH TOÁN'
				end
		end	
	end		
end

EXEC insertthanhtoancheckma 'HD091', 'DH035','NV002','19/07/2022',140000,N'Đã Thanh Toán'
EXEC insertthanhtoancheckma 'HD092', 'DH038','NV009','19/07/2022',379000,N'Chưa Thanh Toán'

--FUNCTION
--FUNCTION 1: VIẾT HÀM TRẢ VỀ 1 BẢNG GỒM MÃ MH, TÊN HÀNG, SL TỒN VỚI NHỮNG HÀNG CÓ SL TỒN < 5
CREATE FUNCTION dbo.HANGTONDUOI5KG()
RETURNS @TB TABLE (MaHang varchar(10), TenHang nvarchar(30), SoLuongTon int)
AS 
BEGIN
	INSERT INTO @TB (MaHang, TenHang, SoLuongTon)
		SELECT MaHang, TenHang, SoLuongTon FROM MATHANG WHERE SoLuongTon < 5
	RETURN;
END

SELECT * FROM dbo.HANGTONDUOI5KG ()

--FUNCTION 2: HÀM ĐỌC DANH SÁCH NHÂN VIÊN THEO CHỨC VỤ
CREATE FUNCTION FN_DSNV (@ChucVu nvarchar(20))
RETURNS TABLE
AS
RETURN 
(
	SELECT * FROM NHANVIEN 
	WHERE ChucVu = @ChucVu
)
GO
SELECT * FROM FN_DSNV (N'Quản lý kho')

--FUNCTION 3: TÍNH SỐ LẦN ĐẶT HÀNG CỦA KHÁCH HÀNG
create function dbo.demsolandathang (@MaKH nvarchar(5))
returns int
as
begin
return
(select bang.solan
from (select dh.MaKH , count(dh.MaKH) AS solan
from KHACHHANG kh, DONHANG dh
where kh.MaKH = dh.MaKH
group by dh.MaKH) as bang
where @MaKH = bang.MaKH)
end

print dbo.demsolandathang('KH003')
print dbo.demsolandathang('KH026')
 

 --CAU 10
--Trigger1 cập nhật hàng trong kho sau khi đặt hàng
create trigger tr_capnhat ON CHITIETDONHANG AFTER INSERT
AS
BEGIN
update MATHANG
set SoLuongTon = SoLuongTon - ( 
	select SoLuong 
	from inserted
	where MaHang = MATHANG.MaHang
	)
from MATHANG
join inserted on inserted.MaHang = MATHANG.MaHang
END
insert into DONHANG values ('DH036','KH025',N'Tiền mặt','25/12/2022',NULL,'56/73 Hồng Đức, Tây Hồ, Hà Nội',N'Chưa TT',N'Đang Giao')
insert into CHITIETDONHANG values ('DH036','MH040',4,50000,200000,'GG040')
go
select*from MATHANG
go
select*from CHITIETDONHANG

--Trigger2 cập nhật hàng trong kho sau khi hủy đặt hàng
create trigger tr_Huydondat on CHITIETDONHANG FOR DELETE
AS
BEGIN
update MATHANG
set SoLuongTon = SoLuongTon + (
	select SoLuong from deleted where MaHang = MATHANG.MaHang)
from MATHANG
join deleted on deleted.MaHang = MATHANG.MaHang
END
delete CHITIETDONHANG where MaDH = 'DH001' and MaHang = 'MH002'
SELECT*FROM MATHANG
SELECT*FROM CHITIETDONHANG

--Trigger3 cập nhật hàng trong kho sau khi người dùng sửa đơn hàng
create trigger tr_capnhathang on CHITIETDONHANG after update
as
begin
update MATHANG 
set SoLuongTon = MatHang.SoLuongTon - 
				(select	SoLuong from inserted where MaHang = MATHANG.MaHang) +
				(select SoLuong from deleted where MaHang = MATHANG.MaHang)
from MATHANG
join deleted on MATHANG.MaHang = deleted.MaHang
end
update CHITIETDONHANG SET SoLuong = 6 WHERE MaDH = 'DH034' and  MaHang = 'MH038'
SELECT*FROM CHITIETDONHANG
SELECT*FROM MATHANG

--Trigger4 thêm số lượng hàng vào kho sau khi nhân viên nhập hàng
create trigger tr_themhangvaokho on CHITIETPHIEUNHAP after insert
as 
begin
update MATHANG
set SoLuongTon = MATHANG.SoLuongTon + (
	select SoLuong from inserted where MaHang = MATHANG.MaHang)
from MATHANG
join inserted on inserted.MaHang = MatHang.MaHang
end

insert into CHITIETPHIEUNHAP values ('PN010',N'MH006',2,90000)
select*from CHITIETPHIEUNHAP
select*from MATHANG

--Trigger5 xóa hàng trong kho sau khi nhân viên xuất kho
create trigger tr_xoahangtrongkho on CHITIETPHIEUXUAT FOR DELETE
AS
begin
update MATHANG
Set SoLuongTon = SoLuongTon - (
	select SoLuong from deleted where MaHang = MATHANG.MaHang)
from MATHANG
join deleted on deleted.MaHang = MATHANG.MaHang
end

delete from CHITIETPHIEUXUAT where MaPX = 'PX002' and MaHang = 'MH010'
select*from CHITIETPHIEUXUAT
select*from MATHANG

--CAU 11: PHAN QUYEN
---tạo đăng nhập cho nhân viên
create login lananhql with password ='462144893'
create login hongducbh with password ='272189751'
create login chitaibh with password ='94782925'
create login thanhnhaqlkho with password ='101804029'
create login hoanglankho with password ='141833271'
create login hoangsongh with password ='530111683'
---tạo user cho login
create user US01 for login lananhql
create user US02 for login hongducbh
create user US03 for login chitaibh 
create user US04 for login thanhnhaqlkho
create user US05 for login hoanglankho
create user US06 for login  hoangsongh
---gán quyền cho nhân viên
----nhân viên xuất hàng
grant select,update,insert,delete on PHIEUXUAT to US05
grant select,update,insert,delete on PHIEUXUAT to US04
grant select,update,insert,delete on PHIEUXUAT to US01

grant select,update,insert,delete on KHO to US05
grant select,update,insert,delete on KHO to US04
grant select,update,insert,delete on KHO to US01


grant select,update,insert,delete on NHACUNGCAP to US05
grant select,update,insert,delete on NHACUNGCAP to US04
grant select,update,insert,delete on NHACUNGCAP to US01


grant select,update,insert,delete on CHITIETPHIEUXUAT to US05
grant select,update,insert,delete on CHITIETPHIEUXUAT to US04
grant select,update,insert,delete on CHITIETPHIEUXUAT to US01

--nhân viên nhập hàng
grant select,update,insert,delete on PHIEUNHAP to US04
grant select,update,insert,delete on PHIEUNHAP to US01

grant select,update,insert,delete on CHITIETPHIEUNHAP to US01
grant select,update,insert,delete on CHITIETPHIEUNHAP to US04

--nhân viên bán hàng
grant select,update,insert,delete on DONHANG to US01
grant select,update,insert,delete on DONHANG to US02
grant select,update,insert,delete on DONHANG to US03

grant select,update,insert,delete on CHITIETDONHANG to US01
grant select,update,insert,delete on CHITIETDONHANG to US02
grant select,update,insert,delete on CHITIETDONHANG to US03

grant select,update,insert,delete on GIAMGIA to US01
grant select,update,insert,delete on GIAMGIA to US02
grant select,update,insert,delete on GIAMGIA to US03

grant select,update,insert,delete on KHACHHANG to US01
grant select,update,insert,delete on KHACHHANG to US02
grant select,update,insert,delete on KHACHHANG to US03

grant select,update,insert,delete on MATHANG to US01
grant select,update,insert,delete on MATHANG to US02
grant select,update,insert,delete on MATHANG to US03

grant select,update,insert,delete on LOAIHANG to US01
grant select,update,insert,delete on LOAIHANG to US02
grant select,update,insert,delete on LOAIHANG to US03

grant select,update,insert,delete on THANHTOAN to US01
grant select,update,insert,delete on THANHTOAN to US02
grant select,update,insert,delete on THANHTOAN to US03

--nhân viên giao hàng
grant select,update,insert,delete on PHIEUGIAOHANG to US01
grant select,update,insert,delete on PHIEUGIAOHANG to US06


--CAU 12: Sao lưu dữ liệu
create procedure SaoLuuDuLieu(@tencsdl nvarchar(200),@tentaptin nvarchar(200))
as
begin
	backup database @tencsdl to disk = @tentaptin
end
exec SaoLuuDuLieu 'fruit4', 'c:\backup\fruit4.bak'
--Phục hồi dữ liệu bằng SQL
create procedure restoreDatabase(@tencsdl nvarchar(200), @tentaptin nvarchar(200))
as
begin
restore database @tencsdl from disk = @tentaptin
end
exec restoreDatabase 'fruit4','c:\backup:\fruit4.bak'

select * from GIAMGIA